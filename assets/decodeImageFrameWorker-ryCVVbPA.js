function gi(l,y){const{rows:w,columns:S,data:E}=l,{rows:r,columns:x,data:W}=y,H=[],N=[],L=[];for(let z=0;z<x;z++){const M=z*(S-1)/(x-1);H[z]=Math.floor(M),N[z]=Math.min(H[z]+1,S-1),L[z]=M-H[z]}for(let z=0;z<r;z++){const M=z*(w-1)/(r-1),X=Math.floor(M)*S,q=Math.min(X+S,(w-1)*S),Z=M-Math.floor(M),ue=1-Z,$e=z*x;for(let pe=0;pe<x;pe++){const we=E[X+H[pe]],_e=E[X+N[pe]],oe=E[q+H[pe]],ge=E[q+N[pe]],Pe=1-L[pe];W[$e+pe]=(we*Pe+_e*L[pe])*ue+(oe*Pe+ge*L[pe])*Z}}return W}function yi(l,y){const{rows:w,columns:S,pixelData:E,samplesPerPixel:r=1}=l,{rows:x,columns:W,pixelData:H}=y,N=[];for(let L=0;L<W;L++){const z=L*(S-1)/(W-1);N[L]=Math.floor(z)*r}for(let L=0;L<x;L++){const z=L*(w-1)/(x-1),M=Math.floor(z)*S*r,X=L*W;for(let q=0;q<W;q++)for(let Z=0;Z<r;Z++)H[X+q+Z]=E[M+N[q]+Z]}return H}/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ni=Symbol("Comlink.proxy"),_i=Symbol("Comlink.endpoint"),mi=Symbol("Comlink.releaseProxy"),qn=Symbol("Comlink.finalizer"),Mn=Symbol("Comlink.thrown"),ii=l=>typeof l=="object"&&l!==null||typeof l=="function",wi={canHandle:l=>ii(l)&&l[ni],serialize(l){const{port1:y,port2:w}=new MessageChannel;return Jn(l,y),[w,[w]]},deserialize(l){return l.start(),Ci(l)}},bi={canHandle:l=>ii(l)&&Mn in l,serialize({value:l}){let y;return l instanceof Error?y={isError:!0,value:{message:l.message,name:l.name,stack:l.stack}}:y={isError:!1,value:l},[y,[]]},deserialize(l){throw l.isError?Object.assign(new Error(l.value.message),l.value):l.value}},oi=new Map([["proxy",wi],["throw",bi]]);function Pi(l,y){for(const w of l)if(y===w||w==="*"||w instanceof RegExp&&w.test(y))return!0;return!1}function Jn(l,y=globalThis,w=["*"]){y.addEventListener("message",function S(E){if(!E||!E.data)return;if(!Pi(w,E.origin)){console.warn(`Invalid origin '${E.origin}' for comlink proxy`);return}const{id:r,type:x,path:W}=Object.assign({path:[]},E.data),H=(E.data.argumentList||[]).map(kn);let N;try{const L=W.slice(0,-1).reduce((M,X)=>M[X],l),z=W.reduce((M,X)=>M[X],l);switch(x){case"GET":N=z;break;case"SET":L[W.slice(-1)[0]]=kn(E.data.value),N=!0;break;case"APPLY":N=z.apply(L,H);break;case"CONSTRUCT":{const M=new z(...H);N=Si(M)}break;case"ENDPOINT":{const{port1:M,port2:X}=new MessageChannel;Jn(l,X),N=Ei(M,[M])}break;case"RELEASE":N=void 0;break;default:return}}catch(L){N={value:L,[Mn]:0}}Promise.resolve(N).catch(L=>({value:L,[Mn]:0})).then(L=>{const[z,M]=Nn(L);y.postMessage(Object.assign(Object.assign({},z),{id:r}),M),x==="RELEASE"&&(y.removeEventListener("message",S),ai(y),qn in l&&typeof l[qn]=="function"&&l[qn]())}).catch(L=>{const[z,M]=Nn({value:new TypeError("Unserializable return value"),[Mn]:0});y.postMessage(Object.assign(Object.assign({},z),{id:r}),M)})}),y.start&&y.start()}function Ti(l){return l.constructor.name==="MessagePort"}function ai(l){Ti(l)&&l.close()}function Ci(l,y){return Gn(l,[],y)}function Hn(l){if(l)throw new Error("Proxy has been released and is not useable")}function si(l){return Fn(l,{type:"RELEASE"}).then(()=>{ai(l)})}const Vn=new WeakMap,Bn="FinalizationRegistry"in globalThis&&new FinalizationRegistry(l=>{const y=(Vn.get(l)||0)-1;Vn.set(l,y),y===0&&si(l)});function Ai(l,y){const w=(Vn.get(y)||0)+1;Vn.set(y,w),Bn&&Bn.register(l,y,l)}function $i(l){Bn&&Bn.unregister(l)}function Gn(l,y=[],w=function(){}){let S=!1;const E=new Proxy(w,{get(r,x){if(Hn(S),x===mi)return()=>{$i(E),si(l),S=!0};if(x==="then"){if(y.length===0)return{then:()=>E};const W=Fn(l,{type:"GET",path:y.map(H=>H.toString())}).then(kn);return W.then.bind(W)}return Gn(l,[...y,x])},set(r,x,W){Hn(S);const[H,N]=Nn(W);return Fn(l,{type:"SET",path:[...y,x].map(L=>L.toString()),value:H},N).then(kn)},apply(r,x,W){Hn(S);const H=y[y.length-1];if(H===_i)return Fn(l,{type:"ENDPOINT"}).then(kn);if(H==="bind")return Gn(l,y.slice(0,-1));const[N,L]=Kn(W);return Fn(l,{type:"APPLY",path:y.map(z=>z.toString()),argumentList:N},L).then(kn)},construct(r,x){Hn(S);const[W,H]=Kn(x);return Fn(l,{type:"CONSTRUCT",path:y.map(N=>N.toString()),argumentList:W},H).then(kn)}});return Ai(E,l),E}function Ri(l){return Array.prototype.concat.apply([],l)}function Kn(l){const y=l.map(Nn);return[y.map(w=>w[0]),Ri(y.map(w=>w[1]))]}const ui=new WeakMap;function Ei(l,y){return ui.set(l,y),l}function Si(l){return Object.assign(l,{[ni]:!0})}function Nn(l){for(const[y,w]of oi)if(w.canHandle(l)){const[S,E]=w.serialize(l);return[{type:"HANDLER",name:y,value:S},E]}return[{type:"RAW",value:l},ui.get(l)||[]]}function kn(l){switch(l.type){case"HANDLER":return oi.get(l.name).deserialize(l.value);case"RAW":return l.value}}function Fn(l,y,w){return new Promise(S=>{const E=ki();l.addEventListener("message",function r(x){!x.data||!x.data.id||x.data.id!==E||(l.removeEventListener("message",r),S(x.data))}),l.start&&l.start(),l.postMessage(Object.assign({id:E},y),w)})}function ki(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}async function Qn(l,y){let w=y.buffer,S=y.byteOffset;const E=y.length;return l.bitsAllocated===16?(S%2&&(w=w.slice(S),S=0),l.pixelRepresentation===0?l.pixelData=new Uint16Array(w,S,E/2):l.pixelData=new Int16Array(w,S,E/2)):l.bitsAllocated===8||l.bitsAllocated===1?l.pixelData=y:l.bitsAllocated===32&&(S%2&&(w=w.slice(S),S=0),l.pixelData=new Float32Array(w,S,E/4)),l}function Fi(l){return(l&255)<<8|l>>8&255}async function Di(l,y){if(l.bitsAllocated===16){let w=y.buffer,S=y.byteOffset;const E=y.length;S%2&&(w=w.slice(S),S=0),l.pixelRepresentation===0?l.pixelData=new Uint16Array(w,S,E/2):l.pixelData=new Int16Array(w,S,E/2);for(let r=0;r<l.pixelData.length;r++)l.pixelData[r]=Fi(l.pixelData[r])}else l.bitsAllocated===8&&(l.pixelData=y);return l}async function Oi(l,y){if(l.bitsAllocated===8)return l.planarConfiguration?Ui(l,y):Ii(l,y);if(l.bitsAllocated===16)return ji(l,y);throw new Error("unsupported pixel format for RLE")}function Ii(l,y){const w=y,S=l.rows*l.columns,E=new ArrayBuffer(S*l.samplesPerPixel),r=new DataView(w.buffer,w.byteOffset),x=new Int8Array(w.buffer,w.byteOffset),W=new Int8Array(E);let H=0;const N=r.getInt32(0,!0);for(let L=0;L<N;++L){H=L;let z=r.getInt32((L+1)*4,!0),M=r.getInt32((L+2)*4,!0);M===0&&(M=w.length);const X=S*N;for(;z<M;){const q=x[z++];if(q>=0&&q<=127)for(let Z=0;Z<q+1&&H<X;++Z)W[H]=x[z++],H+=l.samplesPerPixel;else if(q<=-1&&q>=-127){const Z=x[z++];for(let ue=0;ue<-q+1&&H<X;++ue)W[H]=Z,H+=l.samplesPerPixel}}}return l.pixelData=new Uint8Array(E),l}function Ui(l,y){const w=y,S=l.rows*l.columns,E=new ArrayBuffer(S*l.samplesPerPixel),r=new DataView(w.buffer,w.byteOffset),x=new Int8Array(w.buffer,w.byteOffset),W=new Int8Array(E);let H=0;const N=r.getInt32(0,!0);for(let L=0;L<N;++L){H=L*S;let z=r.getInt32((L+1)*4,!0),M=r.getInt32((L+2)*4,!0);M===0&&(M=w.length);const X=S*N;for(;z<M;){const q=x[z++];if(q>=0&&q<=127)for(let Z=0;Z<q+1&&H<X;++Z)W[H]=x[z++],H++;else if(q<=-1&&q>=-127){const Z=x[z++];for(let ue=0;ue<-q+1&&H<X;++ue)W[H]=Z,H++}}}return l.pixelData=new Uint8Array(E),l}function ji(l,y){const w=y,S=l.rows*l.columns,E=new ArrayBuffer(S*l.samplesPerPixel*2),r=new DataView(w.buffer,w.byteOffset),x=new Int8Array(w.buffer,w.byteOffset),W=new Int8Array(E),H=r.getInt32(0,!0);for(let N=0;N<H;++N){let L=0;const z=N===0?1:0;let M=r.getInt32((N+1)*4,!0),X=r.getInt32((N+2)*4,!0);for(X===0&&(X=w.length);M<X;){const q=x[M++];if(q>=0&&q<=127)for(let Z=0;Z<q+1&&L<S;++Z)W[L*2+z]=x[M++],L++;else if(q<=-1&&q>=-127){const Z=x[M++];for(let ue=0;ue<-q+1&&L<S;++ue)W[L*2+z]=Z,L++}}}return l.pixelRepresentation===0?l.pixelData=new Uint16Array(E):l.pixelData=new Int16Array(E),l}function zn(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}function xi(l){if(l.__esModule)return l;var y=l.default;if(typeof y=="function"){var w=function S(){return this instanceof S?Reflect.construct(y,arguments,this.constructor):y.apply(this,arguments)};w.prototype=y.prototype}else w={};return Object.defineProperty(w,"__esModule",{value:!0}),Object.keys(l).forEach(function(S){var E=Object.getOwnPropertyDescriptor(l,S);Object.defineProperty(w,S,E.get?E:{enumerable:!0,get:function(){return l[S]}})}),w}var fi={exports:{}},Wi={},Hi=Object.freeze({__proto__:null,default:Wi}),Qr=xi(Hi);(function(l,y){var w=(()=>{var S=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(S=S||__filename),function(E){E=E||{};var r=typeof E<"u"?E:{},x,W;r.ready=new Promise(function(e,t){x=e,W=t});var H=Object.assign({},r),N="./this.program",L=(e,t)=>{throw t},z=typeof window=="object",M=typeof importScripts=="function",X=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",q="";function Z(e){return r.locateFile?r.locateFile(e,q):q+e}var ue,$e,pe;if(X){var we=Qr,_e=Qr;M?q=_e.dirname(q)+"/":q=__dirname+"/",ue=(e,t)=>(e=Ce(e)?new URL(e):_e.normalize(e),we.readFileSync(e,t?void 0:"utf8")),pe=e=>{var t=ue(e,!0);return t.buffer||(t=new Uint8Array(t)),t},$e=(e,t,o)=>{e=Ce(e)?new URL(e):_e.normalize(e),we.readFile(e,function(c,p){c?o(c):t(p.buffer)})},process.argv.length>1&&(N=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(e){if(!(e instanceof Jt))throw e}),process.on("unhandledRejection",function(e){throw e}),L=(e,t)=>{throw process.exitCode=e,t},r.inspect=function(){return"[Emscripten Module object]"}}else(z||M)&&(M?q=self.location.href:typeof document<"u"&&document.currentScript&&(q=document.currentScript.src),S&&(q=S),q.indexOf("blob:")!==0?q=q.substr(0,q.replace(/[?#].*/,"").lastIndexOf("/")+1):q="",ue=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},M&&(pe=e=>{var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),$e=(e,t,o)=>{var c=new XMLHttpRequest;c.open("GET",e,!0),c.responseType="arraybuffer",c.onload=()=>{if(c.status==200||c.status==0&&c.response){t(c.response);return}o()},c.onerror=o,c.send(null)});var oe=r.print||console.log.bind(console),ge=r.printErr||console.warn.bind(console);Object.assign(r,H),H=null,r.arguments&&r.arguments,r.thisProgram&&(N=r.thisProgram),r.quit&&(L=r.quit);var Pe;r.wasmBinary&&(Pe=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&ft("no native wasm support detected");var ze,wt=!1;function st(e,t){e||ft(t)}var bt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function rr(e,t,o){for(var c=t+o,p=t;e[p]&&!(p>=c);)++p;if(p-t>16&&e.buffer&&bt)return bt.decode(e.subarray(t,p));for(var v="";t<p;){var g=e[t++];if(!(g&128)){v+=String.fromCharCode(g);continue}var _=e[t++]&63;if((g&224)==192){v+=String.fromCharCode((g&31)<<6|_);continue}var P=e[t++]&63;if((g&240)==224?g=(g&15)<<12|_<<6|P:g=(g&7)<<18|_<<12|P<<6|e[t++]&63,g<65536)v+=String.fromCharCode(g);else{var R=g-65536;v+=String.fromCharCode(55296|R>>10,56320|R&1023)}}return v}function hr(e,t){return e?rr(fe,e,t):""}function nr(e,t,o,c){if(!(c>0))return 0;for(var p=o,v=o+c-1,g=0;g<e.length;++g){var _=e.charCodeAt(g);if(_>=55296&&_<=57343){var P=e.charCodeAt(++g);_=65536+((_&1023)<<10)|P&1023}if(_<=127){if(o>=v)break;t[o++]=_}else if(_<=2047){if(o+1>=v)break;t[o++]=192|_>>6,t[o++]=128|_&63}else if(_<=65535){if(o+2>=v)break;t[o++]=224|_>>12,t[o++]=128|_>>6&63,t[o++]=128|_&63}else{if(o+3>=v)break;t[o++]=240|_>>18,t[o++]=128|_>>12&63,t[o++]=128|_>>6&63,t[o++]=128|_&63}}return t[o]=0,o-p}function Ye(e,t,o){return nr(e,fe,t,o)}function me(e){for(var t=0,o=0;o<e.length;++o){var c=e.charCodeAt(o);c<=127?t++:c<=2047?t+=2:c>=55296&&c<=57343?(t+=4,++o):t+=3}return t}var le,ce,fe,ne,ae,ie,he,Bt,Nt;function zt(e){le=e,r.HEAP8=ce=new Int8Array(e),r.HEAP16=ne=new Int16Array(e),r.HEAP32=ie=new Int32Array(e),r.HEAPU8=fe=new Uint8Array(e),r.HEAPU16=ae=new Uint16Array(e),r.HEAPU32=he=new Uint32Array(e),r.HEAPF32=Bt=new Float32Array(e),r.HEAPF64=Nt=new Float64Array(e)}r.INITIAL_MEMORY;var qt,ir=[],gr=[],Dr=[];function Zr(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Rt(r.preRun.shift());Ot(ir)}function en(){Ot(gr)}function tn(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Qe(r.postRun.shift());Ot(Dr)}function Rt(e){ir.unshift(e)}function Ke(e){gr.unshift(e)}function Qe(e){Dr.unshift(e)}var Ze=0,ut=null;function Gt(e){Ze++,r.monitorRunDependencies&&r.monitorRunDependencies(Ze)}function Dt(e){if(Ze--,r.monitorRunDependencies&&r.monitorRunDependencies(Ze),Ze==0&&ut){var t=ut;ut=null,t()}}function ft(e){r.onAbort&&r.onAbort(e),e="Aborted("+e+")",ge(e),wt=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw W(t),t}var Te="data:application/octet-stream;base64,";function be(e){return e.startsWith(Te)}function Ce(e){return e.startsWith("file://")}var Fe;Fe="libjpegturbowasm_decode.wasm",be(Fe)||(Fe=Z(Fe));function Or(e){try{if(e==Fe&&Pe)return new Uint8Array(Pe);if(pe)return pe(e);throw"both async and sync fetching of the wasm failed"}catch(t){ft(t)}}function yr(){if(!Pe&&(z||M)){if(typeof fetch=="function"&&!Ce(Fe))return fetch(Fe,{credentials:"same-origin"}).then(function(e){if(!e.ok)throw"failed to load wasm binary file at '"+Fe+"'";return e.arrayBuffer()}).catch(function(){return Or(Fe)});if($e)return new Promise(function(e,t){$e(Fe,function(o){e(new Uint8Array(o))},t)})}return Promise.resolve().then(function(){return Or(Fe)})}function _r(){var e={a:A};function t(g,_){var P=g.exports;r.asm=P,ze=r.asm.K,zt(ze.buffer),qt=r.asm.M,Ke(r.asm.L),Dt()}Gt();function o(g){t(g.instance)}function c(g){return yr().then(function(_){return WebAssembly.instantiate(_,e)}).then(function(_){return _}).then(g,function(_){ge("failed to asynchronously prepare wasm: "+_),ft(_)})}function p(){return!Pe&&typeof WebAssembly.instantiateStreaming=="function"&&!be(Fe)&&!Ce(Fe)&&!X&&typeof fetch=="function"?fetch(Fe,{credentials:"same-origin"}).then(function(g){var _=WebAssembly.instantiateStreaming(g,e);return _.then(o,function(P){return ge("wasm streaming compile failed: "+P),ge("falling back to ArrayBuffer instantiation"),c(o)})}):c(o)}if(r.instantiateWasm)try{var v=r.instantiateWasm(e,t);return v}catch(g){ge("Module.instantiateWasm callback failed with error: "+g),W(g)}return p().catch(W),{}}function Jt(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Ot(e){for(;e.length>0;)e.shift()(r)}function Ir(e){this.excPtr=e,this.ptr=e-24,this.set_type=function(t){he[this.ptr+4>>2]=t},this.get_type=function(){return he[this.ptr+4>>2]},this.set_destructor=function(t){he[this.ptr+8>>2]=t},this.get_destructor=function(){return he[this.ptr+8>>2]},this.set_refcount=function(t){ie[this.ptr>>2]=t},this.set_caught=function(t){t=t?1:0,ce[this.ptr+12>>0]=t},this.get_caught=function(){return ce[this.ptr+12>>0]!=0},this.set_rethrown=function(t){t=t?1:0,ce[this.ptr+13>>0]=t},this.get_rethrown=function(){return ce[this.ptr+13>>0]!=0},this.init=function(t,o){this.set_adjusted_ptr(0),this.set_type(t),this.set_destructor(o),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var t=ie[this.ptr>>2];ie[this.ptr>>2]=t+1},this.release_ref=function(){var t=ie[this.ptr>>2];return ie[this.ptr>>2]=t-1,t===1},this.set_adjusted_ptr=function(t){he[this.ptr+16>>2]=t},this.get_adjusted_ptr=function(){return he[this.ptr+16>>2]},this.get_exception_ptr=function(){var t=d(this.get_type());if(t)return he[this.excPtr>>2];var o=this.get_adjusted_ptr();return o!==0?o:this.excPtr}}function Me(e,t,o){var c=new Ir(e);throw c.init(t,o),e}var Le={};function ye(e){for(;e.length;){var t=e.pop(),o=e.pop();o(t)}}function Ve(e){return this.fromWireType(ie[e>>2])}var qe={},Be={},It={},mr=48,Xt=57;function Ut(e){if(e===void 0)return"_unknown";e=e.replace(/[^a-zA-Z0-9_]/g,"$");var t=e.charCodeAt(0);return t>=mr&&t<=Xt?"_"+e:e}function et(e,t){return e=Ut(e),new Function("body","return function "+e+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(t)}function tt(e,t){var o=et(t,function(c){this.name=t,this.message=c;var p=new Error(c).stack;p!==void 0&&(this.stack=this.toString()+`
`+p.replace(/^Error(:[^\n]*)?\n/,""))});return o.prototype=Object.create(e.prototype),o.prototype.constructor=o,o.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},o}var ct=void 0;function Ie(e){throw new ct(e)}function Ue(e,t,o){e.forEach(function(_){It[_]=t});function c(_){var P=o(_);P.length!==e.length&&Ie("Mismatched type converter count");for(var R=0;R<e.length;++R)De(e[R],P[R])}var p=new Array(t.length),v=[],g=0;t.forEach((_,P)=>{Be.hasOwnProperty(_)?p[P]=Be[_]:(v.push(_),qe.hasOwnProperty(_)||(qe[_]=[]),qe[_].push(()=>{p[P]=Be[_],++g,g===v.length&&c(p)}))}),v.length===0&&c(p)}function or(e){var t=Le[e];delete Le[e];var o=t.rawConstructor,c=t.rawDestructor,p=t.fields,v=p.map(g=>g.getterReturnType).concat(p.map(g=>g.setterArgumentType));Ue([e],v,g=>{var _={};return p.forEach((P,R)=>{var U=P.fieldName,B=g[R],V=P.getter,te=P.getterContext,ee=g[R+p.length],ve=P.setter,Oe=P.setterContext;_[U]={read:He=>B.fromWireType(V(te,He)),write:(He,Sn)=>{var Vt=[];ve(Oe,He,ee.toWireType(Vt,Sn)),ye(Vt)}}}),[{name:t.name,fromWireType:function(P){var R={};for(var U in _)R[U]=_[U].read(P);return c(P),R},toWireType:function(P,R){for(var U in _)if(!(U in R))throw new TypeError('Missing field:  "'+U+'"');var B=o();for(U in _)_[U].write(B,R[U]);return P!==null&&P.push(c,B),B},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:c}]})}function ar(e,t,o,c,p){}function Ae(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}function lt(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);Y=e}var Y=void 0;function de(e){for(var t="",o=e;fe[o];)t+=Y[fe[o++]];return t}var re=void 0;function Q(e){throw new re(e)}function De(e,t,o={}){if(!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var c=t.name;if(e||Q('type "'+c+'" must have a positive integer typeid pointer'),Be.hasOwnProperty(e)){if(o.ignoreDuplicateRegistrations)return;Q("Cannot register type '"+c+"' twice")}if(Be[e]=t,delete It[e],qe.hasOwnProperty(e)){var p=qe[e];delete qe[e],p.forEach(v=>v())}}function wr(e,t,o,c,p){var v=Ae(o);t=de(t),De(e,{name:t,fromWireType:function(g){return!!g},toWireType:function(g,_){return _?c:p},argPackAdvance:8,readValueFromPointer:function(g){var _;if(o===1)_=ce;else if(o===2)_=ne;else if(o===4)_=ie;else throw new TypeError("Unknown boolean type size: "+t);return this.fromWireType(_[g>>v])},destructorFunction:null})}function br(e){if(!(this instanceof _t)||!(e instanceof _t))return!1;for(var t=this.$$.ptrType.registeredClass,o=this.$$.ptr,c=e.$$.ptrType.registeredClass,p=e.$$.ptr;t.baseClass;)o=t.upcast(o),t=t.baseClass;for(;c.baseClass;)p=c.upcast(p),c=c.baseClass;return t===c&&o===p}function jt(e){return{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType}}function Yt(e){function t(o){return o.$$.ptrType.registeredClass.name}Q(t(e)+" instance already deleted")}var xt=!1;function Re(e){}function Pt(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}function se(e){e.count.value-=1;var t=e.count.value===0;t&&Pt(e)}function rt(e,t,o){if(t===o)return e;if(o.baseClass===void 0)return null;var c=rt(e,t,o.baseClass);return c===null?null:o.downcast(c)}var Wt={};function Pr(){return Object.keys(ht).length}function dt(){var e=[];for(var t in ht)ht.hasOwnProperty(t)&&e.push(ht[t]);return e}var pt=[];function vt(){for(;pt.length;){var e=pt.pop();e.$$.deleteScheduled=!1,e.delete()}}var it=void 0;function rn(e){it=e,pt.length&&it&&it(vt)}function Ht(){r.getInheritedInstanceCount=Pr,r.getLiveInheritedInstances=dt,r.flushPendingDeletes=vt,r.setDelayFunction=rn}var ht={};function Ur(e,t){for(t===void 0&&Q("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}function Tt(e,t){return t=Ur(e,t),ht[t]}function sr(e,t){(!t.ptrType||!t.ptr)&&Ie("makeClassHandle requires ptr and ptrType");var o=!!t.smartPtrType,c=!!t.smartPtr;return o!==c&&Ie("Both smartPtrType and smartPtr must be specified"),t.count={value:1},Et(Object.create(e,{$$:{value:t}}))}function gt(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var o=Tt(this.registeredClass,t);if(o!==void 0){if(o.$$.count.value===0)return o.$$.ptr=t,o.$$.smartPtr=e,o.clone();var c=o.clone();return this.destructor(e),c}function p(){return this.isSmartPointer?sr(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):sr(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var v=this.registeredClass.getActualType(t),g=Wt[v];if(!g)return p.call(this);var _;this.isConst?_=g.constPointerType:_=g.pointerType;var P=rt(t,this.registeredClass,_.registeredClass);return P===null?p.call(this):this.isSmartPointer?sr(_.registeredClass.instancePrototype,{ptrType:_,ptr:P,smartPtrType:this,smartPtr:e}):sr(_.registeredClass.instancePrototype,{ptrType:_,ptr:P})}function Et(e){return typeof FinalizationRegistry>"u"?(Et=t=>t,e):(xt=new FinalizationRegistry(t=>{se(t.$$)}),Et=t=>{var o=t.$$,c=!!o.smartPtr;if(c){var p={$$:o};xt.register(t,p,t)}return t},Re=t=>xt.unregister(t),Et(e))}function Kt(){if(this.$$.ptr||Yt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e=Et(Object.create(Object.getPrototypeOf(this),{$$:{value:jt(this.$$)}}));return e.$$.count.value+=1,e.$$.deleteScheduled=!1,e}function nn(){this.$$.ptr||Yt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Q("Object already scheduled for deletion"),Re(this),se(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Ct(){return!this.$$.ptr}function Mt(){return this.$$.ptr||Yt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Q("Object already scheduled for deletion"),pt.push(this),pt.length===1&&it&&it(vt),this.$$.deleteScheduled=!0,this}function yt(){_t.prototype.isAliasOf=br,_t.prototype.clone=Kt,_t.prototype.delete=nn,_t.prototype.isDeleted=Ct,_t.prototype.deleteLater=Mt}function _t(){}function St(e,t,o){if(e[t].overloadTable===void 0){var c=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||Q("Function '"+o+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[c.argCount]=c}}function on(e,t,o){r.hasOwnProperty(e)?(Q("Cannot register public name '"+e+"' twice"),St(r,e,e),r.hasOwnProperty(o)&&Q("Cannot register multiple overloads of a function with the same number of arguments ("+o+")!"),r[e].overloadTable[o]=t):r[e]=t}function kt(e,t,o,c,p,v,g,_){this.name=e,this.constructor=t,this.instancePrototype=o,this.rawDestructor=c,this.baseClass=p,this.getActualType=v,this.upcast=g,this.downcast=_,this.pureVirtualFunctions=[]}function Tr(e,t,o){for(;t!==o;)t.upcast||Q("Expected null or instance of "+o.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function an(e,t){if(t===null)return this.isReference&&Q("null is not a valid "+this.name),0;t.$$||Q('Cannot pass "'+Ne(t)+'" as a '+this.name),t.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name);var o=t.$$.ptrType.registeredClass,c=Tr(t.$$.ptr,o,this.registeredClass);return c}function sn(e,t){var o;if(t===null)return this.isReference&&Q("null is not a valid "+this.name),this.isSmartPointer?(o=this.rawConstructor(),e!==null&&e.push(this.rawDestructor,o),o):0;t.$$||Q('Cannot pass "'+Ne(t)+'" as a '+this.name),t.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&Q("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var c=t.$$.ptrType.registeredClass;if(o=Tr(t.$$.ptr,c,this.registeredClass),this.isSmartPointer)switch(t.$$.smartPtr===void 0&&Q("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?o=t.$$.smartPtr:Q("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:o=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)o=t.$$.smartPtr;else{var p=t.clone();o=this.rawShare(o,$t.toHandle(function(){p.delete()})),e!==null&&e.push(this.rawDestructor,o)}break;default:Q("Unsupporting sharing policy")}return o}function un(e,t){if(t===null)return this.isReference&&Q("null is not a valid "+this.name),0;t.$$||Q('Cannot pass "'+Ne(t)+'" as a '+this.name),t.$$.ptr||Q("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&Q("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var o=t.$$.ptrType.registeredClass,c=Tr(t.$$.ptr,o,this.registeredClass);return c}function fn(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e}function Se(e){this.rawDestructor&&this.rawDestructor(e)}function Cr(e){e!==null&&e.delete()}function ot(){Ge.prototype.getPointee=fn,Ge.prototype.destructor=Se,Ge.prototype.argPackAdvance=8,Ge.prototype.readValueFromPointer=Ve,Ge.prototype.deleteObject=Cr,Ge.prototype.fromWireType=gt}function Ge(e,t,o,c,p,v,g,_,P,R,U){this.name=e,this.registeredClass=t,this.isReference=o,this.isConst=c,this.isSmartPointer=p,this.pointeeType=v,this.sharingPolicy=g,this.rawGetPointee=_,this.rawConstructor=P,this.rawShare=R,this.rawDestructor=U,!p&&t.baseClass===void 0?c?(this.toWireType=an,this.destructorFunction=null):(this.toWireType=un,this.destructorFunction=null):this.toWireType=sn}function ur(e,t,o){r.hasOwnProperty(e)||Ie("Replacing nonexistant public symbol"),r[e].overloadTable!==void 0&&o!==void 0||(r[e]=t,r[e].argCount=o)}function fr(e,t,o){var c=r["dynCall_"+e];return o&&o.length?c.apply(null,[t].concat(o)):c.call(null,t)}var Qt=[];function Ee(e){var t=Qt[e];return t||(e>=Qt.length&&(Qt.length=e+1),Qt[e]=t=qt.get(e)),t}function jr(e,t,o){if(e.includes("j"))return fr(e,t,o);var c=Ee(t).apply(null,o);return c}function nt(e,t){var o=[];return function(){return o.length=0,Object.assign(o,arguments),jr(e,t,o)}}function je(e,t){e=de(e);function o(){return e.includes("j")?nt(e,t):Ee(t)}var c=o();return typeof c!="function"&&Q("unknown function pointer with signature "+e+": "+t),c}var Ar=void 0;function xe(e){var t=G(e),o=de(t);return j(t),o}function cr(e,t){var o=[],c={};function p(v){if(!c[v]&&!Be[v]){if(It[v]){It[v].forEach(p);return}o.push(v),c[v]=!0}}throw t.forEach(p),new Ar(e+": "+o.map(xe).join([", "]))}function lr(e,t,o,c,p,v,g,_,P,R,U,B,V){U=de(U),v=je(p,v),_&&(_=je(g,_)),R&&(R=je(P,R)),V=je(B,V);var te=Ut(U);on(te,function(){cr("Cannot construct "+U+" due to unbound types",[c])}),Ue([e,t,o],c?[c]:[],function(ee){ee=ee[0];var ve,Oe;c?(ve=ee.registeredClass,Oe=ve.instancePrototype):Oe=_t.prototype;var He=et(te,function(){if(Object.getPrototypeOf(this)!==Sn)throw new re("Use 'new' to construct "+U);if(Vt.constructor_body===void 0)throw new re(U+" has no accessible constructor");var Yn=Vt.constructor_body[arguments.length];if(Yn===void 0)throw new re("Tried to invoke ctor of "+U+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(Vt.constructor_body).toString()+") parameters instead!");return Yn.apply(this,arguments)}),Sn=Object.create(Oe,{constructor:{value:He}});He.prototype=Sn;var Vt=new kt(U,He,Sn,V,ve,v,_,R),Wn=new Ge(U,Vt,!0,!1,!1),On=new Ge(U+"*",Vt,!1,!1,!1),Xn=new Ge(U+" const*",Vt,!1,!0,!1);return Wt[e]={pointerType:On,constPointerType:Xn},ur(te,He),[Wn,On,Xn]})}function xr(e,t){for(var o=[],c=0;c<e;c++)o.push(he[t+c*4>>2]);return o}function Wr(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+typeof e+" which is not a function");var o=et(e.name||"unknownFunctionName",function(){});o.prototype=e.prototype;var c=new o,p=e.apply(c,t);return p instanceof Object?p:c}function We(e,t,o,c,p){var v=t.length;v<2&&Q("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var g=t[1]!==null&&o!==null,_=!1,P=1;P<t.length;++P)if(t[P]!==null&&t[P].destructorFunction===void 0){_=!0;break}for(var R=t[0].name!=="void",U="",B="",P=0;P<v-2;++P)U+=(P!==0?", ":"")+"arg"+P,B+=(P!==0?", ":"")+"arg"+P+"Wired";var V="return function "+Ut(e)+"("+U+`) {
if (arguments.length !== `+(v-2)+`) {
throwBindingError('function `+e+" called with ' + arguments.length + ' arguments, expected "+(v-2)+` args!');
}
`;_&&(V+=`var destructors = [];
`);var te=_?"destructors":"null",ee=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],ve=[Q,c,p,ye,t[0],t[1]];g&&(V+="var thisWired = classParam.toWireType("+te+`, this);
`);for(var P=0;P<v-2;++P)V+="var arg"+P+"Wired = argType"+P+".toWireType("+te+", arg"+P+"); // "+t[P+2].name+`
`,ee.push("argType"+P),ve.push(t[P+2]);if(g&&(B="thisWired"+(B.length>0?", ":"")+B),V+=(R?"var rv = ":"")+"invoker(fn"+(B.length>0?", ":"")+B+`);
`,_)V+=`runDestructors(destructors);
`;else for(var P=g?1:2;P<t.length;++P){var Oe=P===1?"thisWired":"arg"+(P-2)+"Wired";t[P].destructorFunction!==null&&(V+=Oe+"_dtor("+Oe+"); // "+t[P].name+`
`,ee.push(Oe+"_dtor"),ve.push(t[P].destructorFunction))}R&&(V+=`var ret = retType.fromWireType(rv);
return ret;
`),V+=`}
`,ee.push(V);var He=Wr(Function,ee).apply(null,ve);return He}function Je(e,t,o,c,p,v){st(t>0);var g=xr(t,o);p=je(c,p),Ue([],[e],function(_){_=_[0];var P="constructor "+_.name;if(_.registeredClass.constructor_body===void 0&&(_.registeredClass.constructor_body=[]),_.registeredClass.constructor_body[t-1]!==void 0)throw new re("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+_.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return _.registeredClass.constructor_body[t-1]=()=>{cr("Cannot construct "+_.name+" due to unbound types",g)},Ue([],g,function(R){return R.splice(1,0,null),_.registeredClass.constructor_body[t-1]=We(P,R,null,p,v),[]}),[]})}function Zt(e,t,o,c,p,v,g,_){var P=xr(o,c);t=de(t),v=je(p,v),Ue([],[e],function(R){R=R[0];var U=R.name+"."+t;t.startsWith("@@")&&(t=Symbol[t.substring(2)]),_&&R.registeredClass.pureVirtualFunctions.push(t);function B(){cr("Cannot call "+U+" due to unbound types",P)}var V=R.registeredClass.instancePrototype,te=V[t];return te===void 0||te.overloadTable===void 0&&te.className!==R.name&&te.argCount===o-2?(B.argCount=o-2,B.className=R.name,V[t]=B):(St(V,t,U),V[t].overloadTable[o-2]=B),Ue([],P,function(ee){var ve=We(U,ee,R,v,g);return V[t].overloadTable===void 0?(ve.argCount=o-2,V[t]=ve):V[t].overloadTable[o-2]=ve,[]}),[]})}var ke=[],Xe=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function dr(e){e>4&&--Xe[e].refcount===0&&(Xe[e]=void 0,ke.push(e))}function At(){for(var e=0,t=5;t<Xe.length;++t)Xe[t]!==void 0&&++e;return e}function $r(){for(var e=5;e<Xe.length;++e)if(Xe[e]!==void 0)return Xe[e];return null}function at(){r.count_emval_handles=At,r.get_first_emval=$r}var $t={toValue:e=>(e||Q("Cannot use deleted val. handle = "+e),Xe[e].value),toHandle:e=>{switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var t=ke.length?ke.pop():Xe.length;return Xe[t]={refcount:1,value:e},t}}}};function er(e,t){t=de(t),De(e,{name:t,fromWireType:function(o){var c=$t.toValue(o);return dr(o),c},toWireType:function(o,c){return $t.toHandle(c)},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:null})}function Ne(e){if(e===null)return"null";var t=typeof e;return t==="object"||t==="array"||t==="function"?e.toString():""+e}function Hr(e,t){switch(t){case 2:return function(o){return this.fromWireType(Bt[o>>2])};case 3:return function(o){return this.fromWireType(Nt[o>>3])};default:throw new TypeError("Unknown float type: "+e)}}function cn(e,t,o){var c=Ae(o);t=de(t),De(e,{name:t,fromWireType:function(p){return p},toWireType:function(p,v){return v},argPackAdvance:8,readValueFromPointer:Hr(t,c),destructorFunction:null})}function ln(e,t,o){switch(t){case 0:return o?function(p){return ce[p]}:function(p){return fe[p]};case 1:return o?function(p){return ne[p>>1]}:function(p){return ae[p>>1]};case 2:return o?function(p){return ie[p>>2]}:function(p){return he[p>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function dn(e,t,o,c,p){t=de(t);var v=Ae(o),g=B=>B;if(c===0){var _=32-8*o;g=B=>B<<_>>>_}var P=t.includes("unsigned"),R=(B,V)=>{},U;P?U=function(B,V){return R(V,this.name),V>>>0}:U=function(B,V){return R(V,this.name),V},De(e,{name:t,fromWireType:g,toWireType:U,argPackAdvance:8,readValueFromPointer:ln(t,v,c!==0),destructorFunction:null})}function tr(e,t,o){var c=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],p=c[t];function v(g){g=g>>2;var _=he,P=_[g],R=_[g+1];return new p(le,R,P)}o=de(o),De(e,{name:o,fromWireType:v,argPackAdvance:8,readValueFromPointer:v},{ignoreDuplicateRegistrations:!0})}function Mr(e,t){t=de(t);var o=t==="std::string";De(e,{name:t,fromWireType:function(c){var p=he[c>>2],v=c+4,g;if(o)for(var _=v,P=0;P<=p;++P){var R=v+P;if(P==p||fe[R]==0){var U=R-_,B=hr(_,U);g===void 0?g=B:(g+="\0",g+=B),_=R+1}}else{for(var V=new Array(p),P=0;P<p;++P)V[P]=String.fromCharCode(fe[v+P]);g=V.join("")}return j(c),g},toWireType:function(c,p){p instanceof ArrayBuffer&&(p=new Uint8Array(p));var v,g=typeof p=="string";g||p instanceof Uint8Array||p instanceof Uint8ClampedArray||p instanceof Int8Array||Q("Cannot pass non-string to std::string"),o&&g?v=me(p):v=p.length;var _=O(4+v+1),P=_+4;if(he[_>>2]=v,o&&g)Ye(p,P,v+1);else if(g)for(var R=0;R<v;++R){var U=p.charCodeAt(R);U>255&&(j(P),Q("String has UTF-16 code units that do not fit in 8 bits")),fe[P+R]=U}else for(var R=0;R<v;++R)fe[P+R]=p[R];return c!==null&&c.push(j,_),_},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:function(c){j(c)}})}var pr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function pn(e,t){for(var o=e,c=o>>1,p=c+t/2;!(c>=p)&&ae[c];)++c;if(o=c<<1,o-e>32&&pr)return pr.decode(fe.subarray(e,o));for(var v="",g=0;!(g>=t/2);++g){var _=ne[e+g*2>>1];if(_==0)break;v+=String.fromCharCode(_)}return v}function vn(e,t,o){if(o===void 0&&(o=2147483647),o<2)return 0;o-=2;for(var c=t,p=o<e.length*2?o/2:e.length,v=0;v<p;++v){var g=e.charCodeAt(v);ne[t>>1]=g,t+=2}return ne[t>>1]=0,t-c}function hn(e){return e.length*2}function gn(e,t){for(var o=0,c="";!(o>=t/4);){var p=ie[e+o*4>>2];if(p==0)break;if(++o,p>=65536){var v=p-65536;c+=String.fromCharCode(55296|v>>10,56320|v&1023)}else c+=String.fromCharCode(p)}return c}function yn(e,t,o){if(o===void 0&&(o=2147483647),o<4)return 0;for(var c=t,p=c+o-4,v=0;v<e.length;++v){var g=e.charCodeAt(v);if(g>=55296&&g<=57343){var _=e.charCodeAt(++v);g=65536+((g&1023)<<10)|_&1023}if(ie[t>>2]=g,t+=4,t+4>p)break}return ie[t>>2]=0,t-c}function _n(e){for(var t=0,o=0;o<e.length;++o){var c=e.charCodeAt(o);c>=55296&&c<=57343&&++o,t+=4}return t}function mn(e,t,o){o=de(o);var c,p,v,g,_;t===2?(c=pn,p=vn,g=hn,v=()=>ae,_=1):t===4&&(c=gn,p=yn,g=_n,v=()=>he,_=2),De(e,{name:o,fromWireType:function(P){for(var R=he[P>>2],U=v(),B,V=P+4,te=0;te<=R;++te){var ee=P+4+te*t;if(te==R||U[ee>>_]==0){var ve=ee-V,Oe=c(V,ve);B===void 0?B=Oe:(B+="\0",B+=Oe),V=ee+t}}return j(P),B},toWireType:function(P,R){typeof R!="string"&&Q("Cannot pass non-string to C++ string type "+o);var U=g(R),B=O(4+U+t);return he[B>>2]=U>>_,p(R,B+4,U+t),P!==null&&P.push(j,B),B},argPackAdvance:8,readValueFromPointer:Ve,destructorFunction:function(P){j(P)}})}function Lr(e,t,o,c,p,v){Le[e]={name:de(t),rawConstructor:je(o,c),rawDestructor:je(p,v),fields:[]}}function wn(e,t,o,c,p,v,g,_,P,R){Le[e].fields.push({fieldName:de(t),getterReturnType:o,getter:je(c,p),getterContext:v,setterArgumentType:g,setter:je(_,P),setterContext:R})}function bn(e,t){t=de(t),De(e,{isVoid:!0,name:t,argPackAdvance:0,fromWireType:function(){},toWireType:function(o,c){}})}function Vr(){throw 1/0}var Br={};function Pn(e){var t=Br[e];return t===void 0?de(e):t}function Rr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Nr(e){return e===0?$t.toHandle(Rr()):(e=Pn(e),$t.toHandle(Rr()[e]))}function zr(e){e>4&&(Xe[e].refcount+=1)}function Er(e,t){var o=Be[e];return o===void 0&&Q(t+" has unknown type "+xe(e)),o}function Tn(e){for(var t="",o=0;o<e;++o)t+=(o!==0?", ":"")+"arg"+o;for(var c=()=>he,p="return function emval_allocator_"+e+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,o=0;o<e;++o)p+="var argType"+o+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+o+`');
var arg`+o+" = argType"+o+`.readValueFromPointer(args);
args += argType`+o+`['argPackAdvance'];
argTypes += 4;
`;return p+="var obj = new constructor("+t+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",p)(Er,r,$t.toHandle,c)}var qr={};function Cn(e,t,o,c){e=$t.toValue(e);var p=qr[t];return p||(p=Tn(t),qr[t]=p),p(e,o,c)}function Gr(e,t){e=Er(e,"_emval_take_value");var o=e.readValueFromPointer(t);return $t.toHandle(o)}function An(){ft("")}function $n(e,t,o){fe.copyWithin(e,t,t+o)}function Rn(){return 2147483648}function En(e){try{return ze.grow(e-le.byteLength+65535>>>16),zt(ze.buffer),1}catch{}}function Sr(e){var t=fe.length;e=e>>>0;var o=Rn();if(e>o)return!1;let c=(P,R)=>P+(R-P%R)%R;for(var p=1;p<=4;p*=2){var v=t*(1+.2/p);v=Math.min(v,e+100663296);var g=Math.min(o,c(Math.max(e,v),65536)),_=En(g);if(_)return!0}return!1}var kr={};function Ft(){return N||"./this.program"}function Lt(){if(!Lt.strings){var e=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:e,_:Ft()};for(var o in kr)kr[o]===void 0?delete t[o]:t[o]=kr[o];var c=[];for(var o in t)c.push(o+"="+t[o]);Lt.strings=c}return Lt.strings}function mt(e,t,o){for(var c=0;c<e.length;++c)ce[t++>>0]=e.charCodeAt(c);ce[t>>0]=0}function Jr(e,t){var o=0;return Lt().forEach(function(c,p){var v=t+o;he[e+p*4>>2]=v,mt(c,v),o+=c.length+1}),0}function Xr(e,t){var o=Lt();he[e>>2]=o.length;var c=0;return o.forEach(function(p){c+=p.length+1}),he[t>>2]=c,0}function Fr(e){L(e,new Jt(e))}function Yr(e,t){Fr(e)}var vr=Yr;function Kr(e){return 52}function u(e,t,o,c,p){return 70}var f=[null,[],[]];function h(e,t){var o=f[e];t===0||t===10?((e===1?oe:ge)(rr(o,0)),o.length=0):o.push(t)}function b(e,t,o,c){for(var p=0,v=0;v<o;v++){var g=he[t>>2],_=he[t+4>>2];t+=8;for(var P=0;P<_;P++)h(e,fe[g+P]);p+=_}return he[c>>2]=p,0}function C(e){var t=r["_"+e];return t}function k(e,t){ce.set(e,t)}function F(e,t,o,c,p){var v={string:ee=>{var ve=0;if(ee!=null&&ee!==0){var Oe=(ee.length<<2)+1;ve=a(Oe),Ye(ee,ve,Oe)}return ve},array:ee=>{var ve=a(ee.length);return k(ee,ve),ve}};function g(ee){return t==="string"?hr(ee):t==="boolean"?!!ee:ee}var _=C(e),P=[],R=0;if(c)for(var U=0;U<c.length;U++){var B=v[o[U]];B?(R===0&&(R=K()),P[U]=B(c[U])):P[U]=c[U]}var V=_.apply(null,P);function te(ee){return R!==0&&s(R),g(ee)}return V=te(V),V}ct=r.InternalError=tt(Error,"InternalError"),lt(),re=r.BindingError=tt(Error,"BindingError"),yt(),Ht(),ot(),Ar=r.UnboundTypeError=tt(Error,"UnboundTypeError"),at();var A={g:Me,A:or,w:ar,F:wr,u:lr,t:Je,c:Zt,E:er,m:cn,b:dn,a:tr,l:Mr,h:mn,J:Lr,d:wn,G:bn,x:Vr,i:dr,r:Nr,p:zr,q:Cn,s:Gr,j:An,D:$n,y:Sr,z:Jr,B:Xr,I:vr,C:Kr,v:u,k:b,o:T,n:$,H:D,f:m,e:I};_r(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.L).apply(null,arguments)};var O=r._malloc=function(){return(O=r._malloc=r.asm.N).apply(null,arguments)},j=r._free=function(){return(j=r._free=r.asm.O).apply(null,arguments)},G=r.___getTypeName=function(){return(G=r.___getTypeName=r.asm.P).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.Q).apply(null,arguments)};var J=r._setThrew=function(){return(J=r._setThrew=r.asm.R).apply(null,arguments)},K=r.stackSave=function(){return(K=r.stackSave=r.asm.S).apply(null,arguments)},s=r.stackRestore=function(){return(s=r.stackRestore=r.asm.T).apply(null,arguments)},a=r.stackAlloc=function(){return(a=r.stackAlloc=r.asm.U).apply(null,arguments)},d=r.___cxa_is_pointer_type=function(){return(d=r.___cxa_is_pointer_type=r.asm.V).apply(null,arguments)};r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.W).apply(null,arguments)};function m(e,t){var o=K();try{Ee(e)(t)}catch(c){if(s(o),c!==c+0)throw c;J(1,0)}}function T(e,t){var o=K();try{return Ee(e)(t)}catch(c){if(s(o),c!==c+0)throw c;J(1,0)}}function I(e,t,o,c){var p=K();try{Ee(e)(t,o,c)}catch(v){if(s(p),v!==v+0)throw v;J(1,0)}}function D(e,t,o,c){var p=K();try{return Ee(e)(t,o,c)}catch(v){if(s(p),v!==v+0)throw v;J(1,0)}}function $(e,t,o){var c=K();try{return Ee(e)(t,o)}catch(p){if(s(c),p!==p+0)throw p;J(1,0)}}r.ccall=F;var n;ut=function e(){n||i(),n||(ut=e)};function i(e){if(Ze>0||(Zr(),Ze>0))return;function t(){n||(n=!0,r.calledRun=!0,!wt&&(en(),x(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),tn()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),t()},1)):t()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return i(),E.ready}})();l.exports=w})(fi);var Mi=fi.exports,Li=zn(Mi);const Vi=new URL("/dicom-viewer/assets/libjpegturbowasm_decode-daqMmuVl.wasm",import.meta.url),Ln={codec:void 0,decoder:void 0};function Bi(){if(Ln.codec)return Promise.resolve();const l=Li({locateFile:y=>y.endsWith(".wasm")?Vi.toString():y});return new Promise((y,w)=>{l.then(S=>{Ln.codec=S,Ln.decoder=new S.JPEGDecoder,y()},w)})}async function Ni(l,y){await Bi();const w=Ln.decoder;w.getEncodedBuffer(l.length).set(l),w.decode();const E=w.getFrameInfo(),r=w.getDecodedBuffer(),x={columns:E.width,rows:E.height,bitsPerPixel:E.bitsPerSample,signed:y.signed,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:E.componentCount},W=zi(E,r),H={frameInfo:E};return{...y,pixelData:W,imageInfo:x,encodeOptions:H,...H,...x}}function zi(l,y){return l.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}const jn={JpegImage:void 0,decodeConfig:{}};function qi(l){return jn.decodeConfig=l,jn.JpegImage?Promise.resolve():new Promise((y,w)=>{import("./jpeg-BQEpTZHd.js").then(S=>{jn.JpegImage=S.default,y()}).catch(w)})}async function Gi(l,y){if(await qi(),typeof jn.JpegImage>"u")throw new Error("No JPEG Baseline decoder loaded");const w=new jn.JpegImage;if(w.parse(y),w.colorTransform=!1,l.bitsAllocated===8)return l.pixelData=w.getData(l.columns,l.rows),l;if(l.bitsAllocated===16)return l.pixelData=w.getData16(l.columns,l.rows),l}const xn={jpeg:void 0,decodeConfig:{}};function Ji(l){return xn.decodeConfig=l,xn.jpeg?Promise.resolve():new Promise((y,w)=>{import("./lossless-BIYWXcdg.js").then(({Decoder:S})=>{const E=new S;xn.jpeg=E,y()},w)})}async function Zn(l,y){if(await Ji(),typeof xn.jpeg>"u")throw new Error("No JPEG Lossless decoder loaded");const w=l.bitsAllocated<=8?1:2,S=y.buffer,E=xn.jpeg.decode(S,y.byteOffset,y.length,w);return l.pixelRepresentation===0?l.bitsAllocated===16?(l.pixelData=new Uint16Array(E.buffer),l):(l.pixelData=new Uint8Array(E.buffer),l):(l.pixelData=new Int16Array(E.buffer),l)}var ci={exports:{}};(function(l,y){var w=(()=>{var S=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(S=S||__filename),function(E){E=E||{};var r=typeof E<"u"?E:{},x,W;r.ready=new Promise(function(u,f){x=u,W=f});var H=Object.assign({},r),N=typeof window=="object",L=typeof importScripts=="function",z=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",M="";function X(u){return r.locateFile?r.locateFile(u,M):M+u}var q,Z,ue;if(z){var $e=Qr,pe=Qr;L?M=pe.dirname(M)+"/":M=__dirname+"/",q=(u,f)=>(u=ft(u)?new URL(u):pe.normalize(u),$e.readFileSync(u,f?void 0:"utf8")),ue=u=>{var f=q(u,!0);return f.buffer||(f=new Uint8Array(f)),f},Z=(u,f,h)=>{u=ft(u)?new URL(u):pe.normalize(u),$e.readFile(u,function(b,C){b?h(b):f(C.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(u){if(!(u instanceof Or))throw u}),process.on("unhandledRejection",function(u){throw u}),r.inspect=function(){return"[Emscripten Module object]"}}else(N||L)&&(L?M=self.location.href:typeof document<"u"&&document.currentScript&&(M=document.currentScript.src),S&&(M=S),M.indexOf("blob:")!==0?M=M.substr(0,M.replace(/[?#].*/,"").lastIndexOf("/")+1):M="",q=u=>{var f=new XMLHttpRequest;return f.open("GET",u,!1),f.send(null),f.responseText},L&&(ue=u=>{var f=new XMLHttpRequest;return f.open("GET",u,!1),f.responseType="arraybuffer",f.send(null),new Uint8Array(f.response)}),Z=(u,f,h)=>{var b=new XMLHttpRequest;b.open("GET",u,!0),b.responseType="arraybuffer",b.onload=()=>{if(b.status==200||b.status==0&&b.response){f(b.response);return}h()},b.onerror=h,b.send(null)});r.print||console.log.bind(console);var we=r.printErr||console.warn.bind(console);Object.assign(r,H),H=null,r.arguments&&r.arguments,r.thisProgram&&r.thisProgram,r.quit&&r.quit;var _e;r.wasmBinary&&(_e=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&ut("no native wasm support detected");var oe,ge=!1;function Pe(u,f){u||ut(f)}var ze=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function wt(u,f,h){for(var b=f+h,C=f;u[C]&&!(C>=b);)++C;if(C-f>16&&u.buffer&&ze)return ze.decode(u.subarray(f,C));for(var k="";f<C;){var F=u[f++];if(!(F&128)){k+=String.fromCharCode(F);continue}var A=u[f++]&63;if((F&224)==192){k+=String.fromCharCode((F&31)<<6|A);continue}var O=u[f++]&63;if((F&240)==224?F=(F&15)<<12|A<<6|O:F=(F&7)<<18|A<<12|O<<6|u[f++]&63,F<65536)k+=String.fromCharCode(F);else{var j=F-65536;k+=String.fromCharCode(55296|j>>10,56320|j&1023)}}return k}function st(u,f){return u?wt(me,u,f):""}function bt(u,f,h,b){if(!(b>0))return 0;for(var C=h,k=h+b-1,F=0;F<u.length;++F){var A=u.charCodeAt(F);if(A>=55296&&A<=57343){var O=u.charCodeAt(++F);A=65536+((A&1023)<<10)|O&1023}if(A<=127){if(h>=k)break;f[h++]=A}else if(A<=2047){if(h+1>=k)break;f[h++]=192|A>>6,f[h++]=128|A&63}else if(A<=65535){if(h+2>=k)break;f[h++]=224|A>>12,f[h++]=128|A>>6&63,f[h++]=128|A&63}else{if(h+3>=k)break;f[h++]=240|A>>18,f[h++]=128|A>>12&63,f[h++]=128|A>>6&63,f[h++]=128|A&63}}return f[h]=0,h-C}function rr(u,f,h){return bt(u,me,f,h)}function hr(u){for(var f=0,h=0;h<u.length;++h){var b=u.charCodeAt(h);b<=127?f++:b<=2047?f+=2:b>=55296&&b<=57343?(f+=4,++h):f+=3}return f}var nr,Ye,me,le,ce,fe,ne,ae,ie;function he(u){nr=u,r.HEAP8=Ye=new Int8Array(u),r.HEAP16=le=new Int16Array(u),r.HEAP32=fe=new Int32Array(u),r.HEAPU8=me=new Uint8Array(u),r.HEAPU16=ce=new Uint16Array(u),r.HEAPU32=ne=new Uint32Array(u),r.HEAPF32=ae=new Float32Array(u),r.HEAPF64=ie=new Float64Array(u)}r.INITIAL_MEMORY;var Bt,Nt=[],zt=[],qt=[];function ir(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)Zr(r.preRun.shift());yr(Nt)}function gr(){yr(zt)}function Dr(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)tn(r.postRun.shift());yr(qt)}function Zr(u){Nt.unshift(u)}function en(u){zt.unshift(u)}function tn(u){qt.unshift(u)}var Rt=0,Ke=null;function Qe(u){Rt++,r.monitorRunDependencies&&r.monitorRunDependencies(Rt)}function Ze(u){if(Rt--,r.monitorRunDependencies&&r.monitorRunDependencies(Rt),Rt==0&&Ke){var f=Ke;Ke=null,f()}}function ut(u){r.onAbort&&r.onAbort(u),u="Aborted("+u+")",we(u),ge=!0,u+=". Build with -sASSERTIONS for more info.";var f=new WebAssembly.RuntimeError(u);throw W(f),f}var Gt="data:application/octet-stream;base64,";function Dt(u){return u.startsWith(Gt)}function ft(u){return u.startsWith("file://")}var Te;Te="charlswasm_decode.wasm",Dt(Te)||(Te=X(Te));function be(u){try{if(u==Te&&_e)return new Uint8Array(_e);if(ue)return ue(u);throw"both async and sync fetching of the wasm failed"}catch(f){ut(f)}}function Ce(){if(!_e&&(N||L)){if(typeof fetch=="function"&&!ft(Te))return fetch(Te,{credentials:"same-origin"}).then(function(u){if(!u.ok)throw"failed to load wasm binary file at '"+Te+"'";return u.arrayBuffer()}).catch(function(){return be(Te)});if(Z)return new Promise(function(u,f){Z(Te,function(h){u(new Uint8Array(h))},f)})}return Promise.resolve().then(function(){return be(Te)})}function Fe(){var u={a:kr};function f(F,A){var O=F.exports;r.asm=O,oe=r.asm.z,he(oe.buffer),Bt=r.asm.C,en(r.asm.A),Ze()}Qe();function h(F){f(F.instance)}function b(F){return Ce().then(function(A){return WebAssembly.instantiate(A,u)}).then(function(A){return A}).then(F,function(A){we("failed to asynchronously prepare wasm: "+A),ut(A)})}function C(){return!_e&&typeof WebAssembly.instantiateStreaming=="function"&&!Dt(Te)&&!ft(Te)&&!z&&typeof fetch=="function"?fetch(Te,{credentials:"same-origin"}).then(function(F){var A=WebAssembly.instantiateStreaming(F,u);return A.then(h,function(O){return we("wasm streaming compile failed: "+O),we("falling back to ArrayBuffer instantiation"),b(h)})}):b(h)}if(r.instantiateWasm)try{var k=r.instantiateWasm(u,f);return k}catch(F){we("Module.instantiateWasm callback failed with error: "+F),W(F)}return C().catch(W),{}}function Or(u){this.name="ExitStatus",this.message="Program terminated with exit("+u+")",this.status=u}function yr(u){for(;u.length>0;)u.shift()(r)}function _r(u){this.excPtr=u,this.ptr=u-24,this.set_type=function(f){ne[this.ptr+4>>2]=f},this.get_type=function(){return ne[this.ptr+4>>2]},this.set_destructor=function(f){ne[this.ptr+8>>2]=f},this.get_destructor=function(){return ne[this.ptr+8>>2]},this.set_refcount=function(f){fe[this.ptr>>2]=f},this.set_caught=function(f){f=f?1:0,Ye[this.ptr+12>>0]=f},this.get_caught=function(){return Ye[this.ptr+12>>0]!=0},this.set_rethrown=function(f){f=f?1:0,Ye[this.ptr+13>>0]=f},this.get_rethrown=function(){return Ye[this.ptr+13>>0]!=0},this.init=function(f,h){this.set_adjusted_ptr(0),this.set_type(f),this.set_destructor(h),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var f=fe[this.ptr>>2];fe[this.ptr>>2]=f+1},this.release_ref=function(){var f=fe[this.ptr>>2];return fe[this.ptr>>2]=f-1,f===1},this.set_adjusted_ptr=function(f){ne[this.ptr+16>>2]=f},this.get_adjusted_ptr=function(){return ne[this.ptr+16>>2]},this.get_exception_ptr=function(){var f=Yr(this.get_type());if(f)return ne[this.excPtr>>2];var h=this.get_adjusted_ptr();return h!==0?h:this.excPtr}}function Jt(u,f,h){var b=new _r(u);throw b.init(f,h),u}var Ot={};function Ir(u){for(;u.length;){var f=u.pop(),h=u.pop();h(f)}}function Me(u){return this.fromWireType(fe[u>>2])}var Le={},ye={},Ve={},qe=48,Be=57;function It(u){if(u===void 0)return"_unknown";u=u.replace(/[^a-zA-Z0-9_]/g,"$");var f=u.charCodeAt(0);return f>=qe&&f<=Be?"_"+u:u}function mr(u,f){return u=It(u),new Function("body","return function "+u+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(f)}function Xt(u,f){var h=mr(f,function(b){this.name=f,this.message=b;var C=new Error(b).stack;C!==void 0&&(this.stack=this.toString()+`
`+C.replace(/^Error(:[^\n]*)?\n/,""))});return h.prototype=Object.create(u.prototype),h.prototype.constructor=h,h.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},h}var Ut=void 0;function et(u){throw new Ut(u)}function tt(u,f,h){u.forEach(function(A){Ve[A]=f});function b(A){var O=h(A);O.length!==u.length&&et("Mismatched type converter count");for(var j=0;j<u.length;++j)de(u[j],O[j])}var C=new Array(f.length),k=[],F=0;f.forEach((A,O)=>{ye.hasOwnProperty(A)?C[O]=ye[A]:(k.push(A),Le.hasOwnProperty(A)||(Le[A]=[]),Le[A].push(()=>{C[O]=ye[A],++F,F===k.length&&b(C)}))}),k.length===0&&b(C)}function ct(u){var f=Ot[u];delete Ot[u];var h=f.rawConstructor,b=f.rawDestructor,C=f.fields,k=C.map(F=>F.getterReturnType).concat(C.map(F=>F.setterArgumentType));tt([u],k,F=>{var A={};return C.forEach((O,j)=>{var G=O.fieldName,J=F[j],K=O.getter,s=O.getterContext,a=F[j+C.length],d=O.setter,m=O.setterContext;A[G]={read:T=>J.fromWireType(K(s,T)),write:(T,I)=>{var D=[];d(m,T,a.toWireType(D,I)),Ir(D)}}}),[{name:f.name,fromWireType:function(O){var j={};for(var G in A)j[G]=A[G].read(O);return b(O),j},toWireType:function(O,j){for(var G in A)if(!(G in j))throw new TypeError('Missing field:  "'+G+'"');var J=h();for(G in A)A[G].write(J,j[G]);return O!==null&&O.push(b,J),J},argPackAdvance:8,readValueFromPointer:Me,destructorFunction:b}]})}function Ie(u,f,h,b,C){}function Ue(u){switch(u){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+u)}}function or(){for(var u=new Array(256),f=0;f<256;++f)u[f]=String.fromCharCode(f);ar=u}var ar=void 0;function Ae(u){for(var f="",h=u;me[h];)f+=ar[me[h++]];return f}var lt=void 0;function Y(u){throw new lt(u)}function de(u,f,h={}){if(!("argPackAdvance"in f))throw new TypeError("registerType registeredInstance requires argPackAdvance");var b=f.name;if(u||Y('type "'+b+'" must have a positive integer typeid pointer'),ye.hasOwnProperty(u)){if(h.ignoreDuplicateRegistrations)return;Y("Cannot register type '"+b+"' twice")}if(ye[u]=f,delete Ve[u],Le.hasOwnProperty(u)){var C=Le[u];delete Le[u],C.forEach(k=>k())}}function re(u,f,h,b,C){var k=Ue(h);f=Ae(f),de(u,{name:f,fromWireType:function(F){return!!F},toWireType:function(F,A){return A?b:C},argPackAdvance:8,readValueFromPointer:function(F){var A;if(h===1)A=Ye;else if(h===2)A=le;else if(h===4)A=fe;else throw new TypeError("Unknown boolean type size: "+f);return this.fromWireType(A[F>>k])},destructorFunction:null})}function Q(u){if(!(this instanceof Ct)||!(u instanceof Ct))return!1;for(var f=this.$$.ptrType.registeredClass,h=this.$$.ptr,b=u.$$.ptrType.registeredClass,C=u.$$.ptr;f.baseClass;)h=f.upcast(h),f=f.baseClass;for(;b.baseClass;)C=b.upcast(C),b=b.baseClass;return f===b&&h===C}function De(u){return{count:u.count,deleteScheduled:u.deleteScheduled,preservePointerOnDelete:u.preservePointerOnDelete,ptr:u.ptr,ptrType:u.ptrType,smartPtr:u.smartPtr,smartPtrType:u.smartPtrType}}function wr(u){function f(h){return h.$$.ptrType.registeredClass.name}Y(f(u)+" instance already deleted")}var br=!1;function jt(u){}function Yt(u){u.smartPtr?u.smartPtrType.rawDestructor(u.smartPtr):u.ptrType.registeredClass.rawDestructor(u.ptr)}function xt(u){u.count.value-=1;var f=u.count.value===0;f&&Yt(u)}function Re(u,f,h){if(f===h)return u;if(h.baseClass===void 0)return null;var b=Re(u,f,h.baseClass);return b===null?null:h.downcast(b)}var Pt={};function se(){return Object.keys(it).length}function rt(){var u=[];for(var f in it)it.hasOwnProperty(f)&&u.push(it[f]);return u}var Wt=[];function Pr(){for(;Wt.length;){var u=Wt.pop();u.$$.deleteScheduled=!1,u.delete()}}var dt=void 0;function pt(u){dt=u,Wt.length&&dt&&dt(Pr)}function vt(){r.getInheritedInstanceCount=se,r.getLiveInheritedInstances=rt,r.flushPendingDeletes=Pr,r.setDelayFunction=pt}var it={};function rn(u,f){for(f===void 0&&Y("ptr should not be undefined");u.baseClass;)f=u.upcast(f),u=u.baseClass;return f}function Ht(u,f){return f=rn(u,f),it[f]}function ht(u,f){(!f.ptrType||!f.ptr)&&et("makeClassHandle requires ptr and ptrType");var h=!!f.smartPtrType,b=!!f.smartPtr;return h!==b&&et("Both smartPtrType and smartPtr must be specified"),f.count={value:1},Tt(Object.create(u,{$$:{value:f}}))}function Ur(u){var f=this.getPointee(u);if(!f)return this.destructor(u),null;var h=Ht(this.registeredClass,f);if(h!==void 0){if(h.$$.count.value===0)return h.$$.ptr=f,h.$$.smartPtr=u,h.clone();var b=h.clone();return this.destructor(u),b}function C(){return this.isSmartPointer?ht(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:f,smartPtrType:this,smartPtr:u}):ht(this.registeredClass.instancePrototype,{ptrType:this,ptr:u})}var k=this.registeredClass.getActualType(f),F=Pt[k];if(!F)return C.call(this);var A;this.isConst?A=F.constPointerType:A=F.pointerType;var O=Re(f,this.registeredClass,A.registeredClass);return O===null?C.call(this):this.isSmartPointer?ht(A.registeredClass.instancePrototype,{ptrType:A,ptr:O,smartPtrType:this,smartPtr:u}):ht(A.registeredClass.instancePrototype,{ptrType:A,ptr:O})}function Tt(u){return typeof FinalizationRegistry>"u"?(Tt=f=>f,u):(br=new FinalizationRegistry(f=>{xt(f.$$)}),Tt=f=>{var h=f.$$,b=!!h.smartPtr;if(b){var C={$$:h};br.register(f,C,f)}return f},jt=f=>br.unregister(f),Tt(u))}function sr(){if(this.$$.ptr||wr(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var u=Tt(Object.create(Object.getPrototypeOf(this),{$$:{value:De(this.$$)}}));return u.$$.count.value+=1,u.$$.deleteScheduled=!1,u}function gt(){this.$$.ptr||wr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Y("Object already scheduled for deletion"),jt(this),xt(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function Et(){return!this.$$.ptr}function Kt(){return this.$$.ptr||wr(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&Y("Object already scheduled for deletion"),Wt.push(this),Wt.length===1&&dt&&dt(Pr),this.$$.deleteScheduled=!0,this}function nn(){Ct.prototype.isAliasOf=Q,Ct.prototype.clone=sr,Ct.prototype.delete=gt,Ct.prototype.isDeleted=Et,Ct.prototype.deleteLater=Kt}function Ct(){}function Mt(u,f,h){if(u[f].overloadTable===void 0){var b=u[f];u[f]=function(){return u[f].overloadTable.hasOwnProperty(arguments.length)||Y("Function '"+h+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+u[f].overloadTable+")!"),u[f].overloadTable[arguments.length].apply(this,arguments)},u[f].overloadTable=[],u[f].overloadTable[b.argCount]=b}}function yt(u,f,h){r.hasOwnProperty(u)?((h===void 0||r[u].overloadTable!==void 0&&r[u].overloadTable[h]!==void 0)&&Y("Cannot register public name '"+u+"' twice"),Mt(r,u,u),r.hasOwnProperty(h)&&Y("Cannot register multiple overloads of a function with the same number of arguments ("+h+")!"),r[u].overloadTable[h]=f):(r[u]=f,h!==void 0&&(r[u].numArguments=h))}function _t(u,f,h,b,C,k,F,A){this.name=u,this.constructor=f,this.instancePrototype=h,this.rawDestructor=b,this.baseClass=C,this.getActualType=k,this.upcast=F,this.downcast=A,this.pureVirtualFunctions=[]}function St(u,f,h){for(;f!==h;)f.upcast||Y("Expected null or instance of "+h.name+", got an instance of "+f.name),u=f.upcast(u),f=f.baseClass;return u}function on(u,f){if(f===null)return this.isReference&&Y("null is not a valid "+this.name),0;f.$$||Y('Cannot pass "'+at(f)+'" as a '+this.name),f.$$.ptr||Y("Cannot pass deleted object as a pointer of type "+this.name);var h=f.$$.ptrType.registeredClass,b=St(f.$$.ptr,h,this.registeredClass);return b}function kt(u,f){var h;if(f===null)return this.isReference&&Y("null is not a valid "+this.name),this.isSmartPointer?(h=this.rawConstructor(),u!==null&&u.push(this.rawDestructor,h),h):0;f.$$||Y('Cannot pass "'+at(f)+'" as a '+this.name),f.$$.ptr||Y("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&f.$$.ptrType.isConst&&Y("Cannot convert argument of type "+(f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name)+" to parameter type "+this.name);var b=f.$$.ptrType.registeredClass;if(h=St(f.$$.ptr,b,this.registeredClass),this.isSmartPointer)switch(f.$$.smartPtr===void 0&&Y("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:f.$$.smartPtrType===this?h=f.$$.smartPtr:Y("Cannot convert argument of type "+(f.$$.smartPtrType?f.$$.smartPtrType.name:f.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:h=f.$$.smartPtr;break;case 2:if(f.$$.smartPtrType===this)h=f.$$.smartPtr;else{var C=f.clone();h=this.rawShare(h,At.toHandle(function(){C.delete()})),u!==null&&u.push(this.rawDestructor,h)}break;default:Y("Unsupporting sharing policy")}return h}function Tr(u,f){if(f===null)return this.isReference&&Y("null is not a valid "+this.name),0;f.$$||Y('Cannot pass "'+at(f)+'" as a '+this.name),f.$$.ptr||Y("Cannot pass deleted object as a pointer of type "+this.name),f.$$.ptrType.isConst&&Y("Cannot convert argument of type "+f.$$.ptrType.name+" to parameter type "+this.name);var h=f.$$.ptrType.registeredClass,b=St(f.$$.ptr,h,this.registeredClass);return b}function an(u){return this.rawGetPointee&&(u=this.rawGetPointee(u)),u}function sn(u){this.rawDestructor&&this.rawDestructor(u)}function un(u){u!==null&&u.delete()}function fn(){Se.prototype.getPointee=an,Se.prototype.destructor=sn,Se.prototype.argPackAdvance=8,Se.prototype.readValueFromPointer=Me,Se.prototype.deleteObject=un,Se.prototype.fromWireType=Ur}function Se(u,f,h,b,C,k,F,A,O,j,G){this.name=u,this.registeredClass=f,this.isReference=h,this.isConst=b,this.isSmartPointer=C,this.pointeeType=k,this.sharingPolicy=F,this.rawGetPointee=A,this.rawConstructor=O,this.rawShare=j,this.rawDestructor=G,!C&&f.baseClass===void 0?b?(this.toWireType=on,this.destructorFunction=null):(this.toWireType=Tr,this.destructorFunction=null):this.toWireType=kt}function Cr(u,f,h){r.hasOwnProperty(u)||et("Replacing nonexistant public symbol"),r[u].overloadTable!==void 0&&h!==void 0?r[u].overloadTable[h]=f:(r[u]=f,r[u].argCount=h)}function ot(u,f,h){var b=r["dynCall_"+u];return h&&h.length?b.apply(null,[f].concat(h)):b.call(null,f)}var Ge=[];function ur(u){var f=Ge[u];return f||(u>=Ge.length&&(Ge.length=u+1),Ge[u]=f=Bt.get(u)),f}function fr(u,f,h){if(u.includes("j"))return ot(u,f,h);var b=ur(f).apply(null,h);return b}function Qt(u,f){var h=[];return function(){return h.length=0,Object.assign(h,arguments),fr(u,f,h)}}function Ee(u,f){u=Ae(u);function h(){return u.includes("j")?Qt(u,f):ur(f)}var b=h();return typeof b!="function"&&Y("unknown function pointer with signature "+u+": "+f),b}var jr=void 0;function nt(u){var f=Lt(u),h=Ae(f);return mt(f),h}function je(u,f){var h=[],b={};function C(k){if(!b[k]&&!ye[k]){if(Ve[k]){Ve[k].forEach(C);return}h.push(k),b[k]=!0}}throw f.forEach(C),new jr(u+": "+h.map(nt).join([", "]))}function Ar(u,f,h,b,C,k,F,A,O,j,G,J,K){G=Ae(G),k=Ee(C,k),A&&(A=Ee(F,A)),j&&(j=Ee(O,j)),K=Ee(J,K);var s=It(G);yt(s,function(){je("Cannot construct "+G+" due to unbound types",[b])}),tt([u,f,h],b?[b]:[],function(a){a=a[0];var d,m;b?(d=a.registeredClass,m=d.instancePrototype):m=Ct.prototype;var T=mr(s,function(){if(Object.getPrototypeOf(this)!==I)throw new lt("Use 'new' to construct "+G);if(D.constructor_body===void 0)throw new lt(G+" has no accessible constructor");var e=D.constructor_body[arguments.length];if(e===void 0)throw new lt("Tried to invoke ctor of "+G+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(D.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)}),I=Object.create(m,{constructor:{value:T}});T.prototype=I;var D=new _t(G,T,I,K,d,k,A,j),$=new Se(G,D,!0,!1,!1),n=new Se(G+"*",D,!1,!1,!1),i=new Se(G+" const*",D,!1,!0,!1);return Pt[u]={pointerType:n,constPointerType:i},Cr(s,T),[$,n,i]})}function xe(u,f){for(var h=[],b=0;b<u;b++)h.push(ne[f+b*4>>2]);return h}function cr(u,f){if(!(u instanceof Function))throw new TypeError("new_ called with constructor type "+typeof u+" which is not a function");var h=mr(u.name||"unknownFunctionName",function(){});h.prototype=u.prototype;var b=new h,C=u.apply(b,f);return C instanceof Object?C:b}function lr(u,f,h,b,C){var k=f.length;k<2&&Y("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var F=f[1]!==null&&h!==null,A=!1,O=1;O<f.length;++O)if(f[O]!==null&&f[O].destructorFunction===void 0){A=!0;break}for(var j=f[0].name!=="void",G="",J="",O=0;O<k-2;++O)G+=(O!==0?", ":"")+"arg"+O,J+=(O!==0?", ":"")+"arg"+O+"Wired";var K="return function "+It(u)+"("+G+`) {
if (arguments.length !== `+(k-2)+`) {
throwBindingError('function `+u+" called with ' + arguments.length + ' arguments, expected "+(k-2)+` args!');
}
`;A&&(K+=`var destructors = [];
`);var s=A?"destructors":"null",a=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],d=[Y,b,C,Ir,f[0],f[1]];F&&(K+="var thisWired = classParam.toWireType("+s+`, this);
`);for(var O=0;O<k-2;++O)K+="var arg"+O+"Wired = argType"+O+".toWireType("+s+", arg"+O+"); // "+f[O+2].name+`
`,a.push("argType"+O),d.push(f[O+2]);if(F&&(J="thisWired"+(J.length>0?", ":"")+J),K+=(j?"var rv = ":"")+"invoker(fn"+(J.length>0?", ":"")+J+`);
`,A)K+=`runDestructors(destructors);
`;else for(var O=F?1:2;O<f.length;++O){var m=O===1?"thisWired":"arg"+(O-2)+"Wired";f[O].destructorFunction!==null&&(K+=m+"_dtor("+m+"); // "+f[O].name+`
`,a.push(m+"_dtor"),d.push(f[O].destructorFunction))}j&&(K+=`var ret = retType.fromWireType(rv);
return ret;
`),K+=`}
`,a.push(K);var T=cr(Function,a).apply(null,d);return T}function xr(u,f,h,b,C,k){Pe(f>0);var F=xe(f,h);C=Ee(b,C),tt([],[u],function(A){A=A[0];var O="constructor "+A.name;if(A.registeredClass.constructor_body===void 0&&(A.registeredClass.constructor_body=[]),A.registeredClass.constructor_body[f-1]!==void 0)throw new lt("Cannot register multiple constructors with identical number of parameters ("+(f-1)+") for class '"+A.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return A.registeredClass.constructor_body[f-1]=()=>{je("Cannot construct "+A.name+" due to unbound types",F)},tt([],F,function(j){return j.splice(1,0,null),A.registeredClass.constructor_body[f-1]=lr(O,j,null,C,k),[]}),[]})}function Wr(u,f,h,b,C,k,F,A){var O=xe(h,b);f=Ae(f),k=Ee(C,k),tt([],[u],function(j){j=j[0];var G=j.name+"."+f;f.startsWith("@@")&&(f=Symbol[f.substring(2)]),A&&j.registeredClass.pureVirtualFunctions.push(f);function J(){je("Cannot call "+G+" due to unbound types",O)}var K=j.registeredClass.instancePrototype,s=K[f];return s===void 0||s.overloadTable===void 0&&s.className!==j.name&&s.argCount===h-2?(J.argCount=h-2,J.className=j.name,K[f]=J):(Mt(K,f,G),K[f].overloadTable[h-2]=J),tt([],O,function(a){var d=lr(G,a,j,k,F);return K[f].overloadTable===void 0?(d.argCount=h-2,K[f]=d):K[f].overloadTable[h-2]=d,[]}),[]})}var We=[],Je=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Zt(u){u>4&&--Je[u].refcount===0&&(Je[u]=void 0,We.push(u))}function ke(){for(var u=0,f=5;f<Je.length;++f)Je[f]!==void 0&&++u;return u}function Xe(){for(var u=5;u<Je.length;++u)if(Je[u]!==void 0)return Je[u];return null}function dr(){r.count_emval_handles=ke,r.get_first_emval=Xe}var At={toValue:u=>(u||Y("Cannot use deleted val. handle = "+u),Je[u].value),toHandle:u=>{switch(u){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var f=We.length?We.pop():Je.length;return Je[f]={refcount:1,value:u},f}}}};function $r(u,f){f=Ae(f),de(u,{name:f,fromWireType:function(h){var b=At.toValue(h);return Zt(h),b},toWireType:function(h,b){return At.toHandle(b)},argPackAdvance:8,readValueFromPointer:Me,destructorFunction:null})}function at(u){if(u===null)return"null";var f=typeof u;return f==="object"||f==="array"||f==="function"?u.toString():""+u}function $t(u,f){switch(f){case 2:return function(h){return this.fromWireType(ae[h>>2])};case 3:return function(h){return this.fromWireType(ie[h>>3])};default:throw new TypeError("Unknown float type: "+u)}}function er(u,f,h){var b=Ue(h);f=Ae(f),de(u,{name:f,fromWireType:function(C){return C},toWireType:function(C,k){return k},argPackAdvance:8,readValueFromPointer:$t(f,b),destructorFunction:null})}function Ne(u,f,h,b,C,k){var F=xe(f,h);u=Ae(u),C=Ee(b,C),yt(u,function(){je("Cannot call "+u+" due to unbound types",F)},f-1),tt([],F,function(A){var O=[A[0],null].concat(A.slice(1));return Cr(u,lr(u,O,null,C,k),f-1),[]})}function Hr(u,f,h){switch(f){case 0:return h?function(C){return Ye[C]}:function(C){return me[C]};case 1:return h?function(C){return le[C>>1]}:function(C){return ce[C>>1]};case 2:return h?function(C){return fe[C>>2]}:function(C){return ne[C>>2]};default:throw new TypeError("Unknown integer type: "+u)}}function cn(u,f,h,b,C){f=Ae(f);var k=Ue(h),F=J=>J;if(b===0){var A=32-8*h;F=J=>J<<A>>>A}var O=f.includes("unsigned"),j=(J,K)=>{},G;O?G=function(J,K){return j(K,this.name),K>>>0}:G=function(J,K){return j(K,this.name),K},de(u,{name:f,fromWireType:F,toWireType:G,argPackAdvance:8,readValueFromPointer:Hr(f,k,b!==0),destructorFunction:null})}function ln(u,f,h){var b=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],C=b[f];function k(F){F=F>>2;var A=ne,O=A[F],j=A[F+1];return new C(nr,j,O)}h=Ae(h),de(u,{name:h,fromWireType:k,argPackAdvance:8,readValueFromPointer:k},{ignoreDuplicateRegistrations:!0})}function dn(u,f){f=Ae(f);var h=f==="std::string";de(u,{name:f,fromWireType:function(b){var C=ne[b>>2],k=b+4,F;if(h)for(var A=k,O=0;O<=C;++O){var j=k+O;if(O==C||me[j]==0){var G=j-A,J=st(A,G);F===void 0?F=J:(F+="\0",F+=J),A=j+1}}else{for(var K=new Array(C),O=0;O<C;++O)K[O]=String.fromCharCode(me[k+O]);F=K.join("")}return mt(b),F},toWireType:function(b,C){C instanceof ArrayBuffer&&(C=new Uint8Array(C));var k,F=typeof C=="string";F||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int8Array||Y("Cannot pass non-string to std::string"),h&&F?k=hr(C):k=C.length;var A=Ft(4+k+1),O=A+4;if(ne[A>>2]=k,h&&F)rr(C,O,k+1);else if(F)for(var j=0;j<k;++j){var G=C.charCodeAt(j);G>255&&(mt(O),Y("String has UTF-16 code units that do not fit in 8 bits")),me[O+j]=G}else for(var j=0;j<k;++j)me[O+j]=C[j];return b!==null&&b.push(mt,A),A},argPackAdvance:8,readValueFromPointer:Me,destructorFunction:function(b){mt(b)}})}var tr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Mr(u,f){for(var h=u,b=h>>1,C=b+f/2;!(b>=C)&&ce[b];)++b;if(h=b<<1,h-u>32&&tr)return tr.decode(me.subarray(u,h));for(var k="",F=0;!(F>=f/2);++F){var A=le[u+F*2>>1];if(A==0)break;k+=String.fromCharCode(A)}return k}function pr(u,f,h){if(h===void 0&&(h=2147483647),h<2)return 0;h-=2;for(var b=f,C=h<u.length*2?h/2:u.length,k=0;k<C;++k){var F=u.charCodeAt(k);le[f>>1]=F,f+=2}return le[f>>1]=0,f-b}function pn(u){return u.length*2}function vn(u,f){for(var h=0,b="";!(h>=f/4);){var C=fe[u+h*4>>2];if(C==0)break;if(++h,C>=65536){var k=C-65536;b+=String.fromCharCode(55296|k>>10,56320|k&1023)}else b+=String.fromCharCode(C)}return b}function hn(u,f,h){if(h===void 0&&(h=2147483647),h<4)return 0;for(var b=f,C=b+h-4,k=0;k<u.length;++k){var F=u.charCodeAt(k);if(F>=55296&&F<=57343){var A=u.charCodeAt(++k);F=65536+((F&1023)<<10)|A&1023}if(fe[f>>2]=F,f+=4,f+4>C)break}return fe[f>>2]=0,f-b}function gn(u){for(var f=0,h=0;h<u.length;++h){var b=u.charCodeAt(h);b>=55296&&b<=57343&&++h,f+=4}return f}function yn(u,f,h){h=Ae(h);var b,C,k,F,A;f===2?(b=Mr,C=pr,F=pn,k=()=>ce,A=1):f===4&&(b=vn,C=hn,F=gn,k=()=>ne,A=2),de(u,{name:h,fromWireType:function(O){for(var j=ne[O>>2],G=k(),J,K=O+4,s=0;s<=j;++s){var a=O+4+s*f;if(s==j||G[a>>A]==0){var d=a-K,m=b(K,d);J===void 0?J=m:(J+="\0",J+=m),K=a+f}}return mt(O),J},toWireType:function(O,j){typeof j!="string"&&Y("Cannot pass non-string to C++ string type "+h);var G=F(j),J=Ft(4+G+f);return ne[J>>2]=G>>A,C(j,J+4,G+f),O!==null&&O.push(mt,J),J},argPackAdvance:8,readValueFromPointer:Me,destructorFunction:function(O){mt(O)}})}function _n(u,f,h,b,C,k){Ot[u]={name:Ae(f),rawConstructor:Ee(h,b),rawDestructor:Ee(C,k),fields:[]}}function mn(u,f,h,b,C,k,F,A,O,j){Ot[u].fields.push({fieldName:Ae(f),getterReturnType:h,getter:Ee(b,C),getterContext:k,setterArgumentType:F,setter:Ee(A,O),setterContext:j})}function Lr(u,f){f=Ae(f),de(u,{isVoid:!0,name:f,argPackAdvance:0,fromWireType:function(){},toWireType:function(h,b){}})}var wn={};function bn(u){var f=wn[u];return f===void 0?Ae(u):f}function Vr(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Br(u){return u===0?At.toHandle(Vr()):(u=bn(u),At.toHandle(Vr()[u]))}function Pn(u){u>4&&(Je[u].refcount+=1)}function Rr(u,f){var h=ye[u];return h===void 0&&Y(f+" has unknown type "+nt(u)),h}function Nr(u){for(var f="",h=0;h<u;++h)f+=(h!==0?", ":"")+"arg"+h;for(var b=()=>ne,C="return function emval_allocator_"+u+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,h=0;h<u;++h)C+="var argType"+h+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+h+`');
var arg`+h+" = argType"+h+`.readValueFromPointer(args);
args += argType`+h+`['argPackAdvance'];
argTypes += 4;
`;return C+="var obj = new constructor("+f+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",C)(Rr,r,At.toHandle,b)}var zr={};function Er(u,f,h,b){u=At.toValue(u);var C=zr[f];return C||(C=Nr(f),zr[f]=C),C(u,h,b)}function Tn(u,f){u=Rr(u,"_emval_take_value");var h=u.readValueFromPointer(f);return At.toHandle(h)}function qr(){ut("")}function Cn(u,f,h){me.copyWithin(u,f,f+h)}function Gr(){return 2147483648}function An(u){try{return oe.grow(u-nr.byteLength+65535>>>16),he(oe.buffer),1}catch{}}function $n(u){var f=me.length;u=u>>>0;var h=Gr();if(u>h)return!1;let b=(O,j)=>O+(j-O%j)%j;for(var C=1;C<=4;C*=2){var k=f*(1+.2/C);k=Math.min(k,u+100663296);var F=Math.min(h,b(Math.max(u,k),65536)),A=An(F);if(A)return!0}return!1}function Rn(u){var f=r["_"+u];return f}function En(u,f){Ye.set(u,f)}function Sr(u,f,h,b,C){var k={string:a=>{var d=0;if(a!=null&&a!==0){var m=(a.length<<2)+1;d=Fr(m),rr(a,d,m)}return d},array:a=>{var d=Fr(a.length);return En(a,d),d}};function F(a){return f==="string"?st(a):f==="boolean"?!!a:a}var A=Rn(u),O=[],j=0;if(b)for(var G=0;G<b.length;G++){var J=k[h[G]];J?(j===0&&(j=Jr()),O[G]=J(b[G])):O[G]=b[G]}var K=A.apply(null,O);function s(a){return j!==0&&Xr(j),F(a)}return K=s(K),K}Ut=r.InternalError=Xt(Error,"InternalError"),or(),lt=r.BindingError=Xt(Error,"BindingError"),nn(),vt(),fn(),jr=r.UnboundTypeError=Xt(Error,"UnboundTypeError"),dr();var kr={h:Jt,q:ct,r:Ie,w:re,p:Ar,o:xr,c:Wr,v:$r,k:er,e:Ne,b:cn,a:ln,j:dn,g:yn,u:_n,d:mn,x:Lr,i:Zt,m:Br,l:Pn,y:Er,n:Tn,f:qr,t:Cn,s:$n};Fe(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.A).apply(null,arguments)};var Ft=r._malloc=function(){return(Ft=r._malloc=r.asm.B).apply(null,arguments)},Lt=r.___getTypeName=function(){return(Lt=r.___getTypeName=r.asm.D).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.E).apply(null,arguments)};var mt=r._free=function(){return(mt=r._free=r.asm.F).apply(null,arguments)},Jr=r.stackSave=function(){return(Jr=r.stackSave=r.asm.G).apply(null,arguments)},Xr=r.stackRestore=function(){return(Xr=r.stackRestore=r.asm.H).apply(null,arguments)},Fr=r.stackAlloc=function(){return(Fr=r.stackAlloc=r.asm.I).apply(null,arguments)},Yr=r.___cxa_is_pointer_type=function(){return(Yr=r.___cxa_is_pointer_type=r.asm.J).apply(null,arguments)};r.ccall=Sr;var vr;Ke=function u(){vr||Kr(),vr||(Ke=u)};function Kr(u){if(Rt>0||(ir(),Rt>0))return;function f(){vr||(vr=!0,r.calledRun=!0,!ge&&(gr(),x(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Dr()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),f()},1)):f()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return Kr(),E.ready}})();l.exports=w})(ci);var Xi=ci.exports,Yi=zn(Xi);const Ki=new URL("/dicom-viewer/assets/charlswasm_decode-484ovEoR.wasm",import.meta.url),Dn={codec:void 0,decoder:void 0,decodeConfig:{}};function Qi(l){return typeof l=="number"?Dn.codec.getExceptionMessage(l):l}function Zi(l){if(Dn.decodeConfig=l,Dn.codec)return Promise.resolve();const y=Yi({locateFile:w=>w.endsWith(".wasm")?Ki.toString():w});return new Promise((w,S)=>{y.then(E=>{Dn.codec=E,Dn.decoder=new E.JpegLSDecoder,w()},S)})}async function ei(l,y){try{await Zi();const w=Dn.decoder;w.getEncodedBuffer(l.length).set(l),w.decode();const E=w.getFrameInfo(),r=w.getInterleaveMode(),x=w.getNearLossless(),W=w.getDecodedBuffer(),H={columns:E.width,rows:E.height,bitsPerPixel:E.bitsPerSample,signed:y.signed,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:E.componentCount},N=eo(E,W,y.signed),L={nearLossless:x,interleaveMode:r,frameInfo:E};return{...y,pixelData:N,imageInfo:H,encodeOptions:L,...L,...H}}catch(w){throw Qi(w)}}function eo(l,y,w){return l.bitsPerSample>8?w?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):w?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}var li={exports:{}};(function(l,y){var w=(()=>{var S=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(S=S||__filename),function(E){E=E||{};var r=typeof E<"u"?E:{},x,W;r.ready=new Promise(function(s,a){x=s,W=a});var H=Object.assign({},r),N="./this.program",L=typeof window=="object",z=typeof importScripts=="function",M=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",X="";function q(s){return r.locateFile?r.locateFile(s,X):X+s}var Z,ue,$e;if(M){var pe=Qr,we=Qr;z?X=we.dirname(X)+"/":X=__dirname+"/",Z=(s,a)=>(s=be(s)?new URL(s):we.normalize(s),pe.readFileSync(s,a?void 0:"utf8")),$e=s=>{var a=Z(s,!0);return a.buffer||(a=new Uint8Array(a)),a},ue=(s,a,d)=>{s=be(s)?new URL(s):we.normalize(s),pe.readFile(s,function(m,T){m?d(m):a(T.buffer)})},process.argv.length>1&&(N=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),process.on("uncaughtException",function(s){if(!(s instanceof _r))throw s}),process.on("unhandledRejection",function(s){throw s}),r.inspect=function(){return"[Emscripten Module object]"}}else(L||z)&&(z?X=self.location.href:typeof document<"u"&&document.currentScript&&(X=document.currentScript.src),S&&(X=S),X.indexOf("blob:")!==0?X=X.substr(0,X.replace(/[?#].*/,"").lastIndexOf("/")+1):X="",Z=s=>{var a=new XMLHttpRequest;return a.open("GET",s,!1),a.send(null),a.responseText},z&&($e=s=>{var a=new XMLHttpRequest;return a.open("GET",s,!1),a.responseType="arraybuffer",a.send(null),new Uint8Array(a.response)}),ue=(s,a,d)=>{var m=new XMLHttpRequest;m.open("GET",s,!0),m.responseType="arraybuffer",m.onload=()=>{if(m.status==200||m.status==0&&m.response){a(m.response);return}d()},m.onerror=d,m.send(null)});var _e=r.print||console.log.bind(console),oe=r.printErr||console.warn.bind(console);Object.assign(r,H),H=null,r.arguments&&r.arguments,r.thisProgram&&(N=r.thisProgram),r.quit&&r.quit;var ge;r.wasmBinary&&(ge=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&Dt("no native wasm support detected");var Pe,ze=!1;function wt(s,a){s||Dt(a)}var st=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function bt(s,a,d){for(var m=a+d,T=a;s[T]&&!(T>=m);)++T;if(T-a>16&&s.buffer&&st)return st.decode(s.subarray(a,T));for(var I="";a<T;){var D=s[a++];if(!(D&128)){I+=String.fromCharCode(D);continue}var $=s[a++]&63;if((D&224)==192){I+=String.fromCharCode((D&31)<<6|$);continue}var n=s[a++]&63;if((D&240)==224?D=(D&15)<<12|$<<6|n:D=(D&7)<<18|$<<12|n<<6|s[a++]&63,D<65536)I+=String.fromCharCode(D);else{var i=D-65536;I+=String.fromCharCode(55296|i>>10,56320|i&1023)}}return I}function rr(s,a){return s?bt(ce,s,a):""}function hr(s,a,d,m){if(!(m>0))return 0;for(var T=d,I=d+m-1,D=0;D<s.length;++D){var $=s.charCodeAt(D);if($>=55296&&$<=57343){var n=s.charCodeAt(++D);$=65536+(($&1023)<<10)|n&1023}if($<=127){if(d>=I)break;a[d++]=$}else if($<=2047){if(d+1>=I)break;a[d++]=192|$>>6,a[d++]=128|$&63}else if($<=65535){if(d+2>=I)break;a[d++]=224|$>>12,a[d++]=128|$>>6&63,a[d++]=128|$&63}else{if(d+3>=I)break;a[d++]=240|$>>18,a[d++]=128|$>>12&63,a[d++]=128|$>>6&63,a[d++]=128|$&63}}return a[d]=0,d-T}function nr(s,a,d){return hr(s,ce,a,d)}function Ye(s){for(var a=0,d=0;d<s.length;++d){var m=s.charCodeAt(d);m<=127?a++:m<=2047?a+=2:m>=55296&&m<=57343?(a+=4,++d):a+=3}return a}var me,le,ce,fe,ne,ae,ie,he,Bt;function Nt(s){me=s,r.HEAP8=le=new Int8Array(s),r.HEAP16=fe=new Int16Array(s),r.HEAP32=ae=new Int32Array(s),r.HEAPU8=ce=new Uint8Array(s),r.HEAPU16=ne=new Uint16Array(s),r.HEAPU32=ie=new Uint32Array(s),r.HEAPF32=he=new Float32Array(s),r.HEAPF64=Bt=new Float64Array(s)}r.INITIAL_MEMORY;var zt,qt=[],ir=[],gr=[];function Dr(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)tn(r.preRun.shift());Jt(qt)}function Zr(){Jt(ir)}function en(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Ke(r.postRun.shift());Jt(gr)}function tn(s){qt.unshift(s)}function Rt(s){ir.unshift(s)}function Ke(s){gr.unshift(s)}var Qe=0,Ze=null;function ut(s){Qe++,r.monitorRunDependencies&&r.monitorRunDependencies(Qe)}function Gt(s){if(Qe--,r.monitorRunDependencies&&r.monitorRunDependencies(Qe),Qe==0&&Ze){var a=Ze;Ze=null,a()}}function Dt(s){r.onAbort&&r.onAbort(s),s="Aborted("+s+")",oe(s),ze=!0,s+=". Build with -sASSERTIONS for more info.";var a=new WebAssembly.RuntimeError(s);throw W(a),a}var ft="data:application/octet-stream;base64,";function Te(s){return s.startsWith(ft)}function be(s){return s.startsWith("file://")}var Ce;Ce="openjpegwasm_decode.wasm",Te(Ce)||(Ce=q(Ce));function Fe(s){try{if(s==Ce&&ge)return new Uint8Array(ge);if($e)return $e(s);throw"both async and sync fetching of the wasm failed"}catch(a){Dt(a)}}function Or(){if(!ge&&(L||z)){if(typeof fetch=="function"&&!be(Ce))return fetch(Ce,{credentials:"same-origin"}).then(function(s){if(!s.ok)throw"failed to load wasm binary file at '"+Ce+"'";return s.arrayBuffer()}).catch(function(){return Fe(Ce)});if(ue)return new Promise(function(s,a){ue(Ce,function(d){s(new Uint8Array(d))},a)})}return Promise.resolve().then(function(){return Fe(Ce)})}function yr(){var s={a:b};function a(D,$){var n=D.exports;r.asm=n,Pe=r.asm.E,Nt(Pe.buffer),zt=r.asm.G,Rt(r.asm.F),Gt()}ut();function d(D){a(D.instance)}function m(D){return Or().then(function($){return WebAssembly.instantiate($,s)}).then(function($){return $}).then(D,function($){oe("failed to asynchronously prepare wasm: "+$),Dt($)})}function T(){return!ge&&typeof WebAssembly.instantiateStreaming=="function"&&!Te(Ce)&&!be(Ce)&&!M&&typeof fetch=="function"?fetch(Ce,{credentials:"same-origin"}).then(function(D){var $=WebAssembly.instantiateStreaming(D,s);return $.then(d,function(n){return oe("wasm streaming compile failed: "+n),oe("falling back to ArrayBuffer instantiation"),m(d)})}):m(d)}if(r.instantiateWasm)try{var I=r.instantiateWasm(s,a);return I}catch(D){oe("Module.instantiateWasm callback failed with error: "+D),W(D)}return T().catch(W),{}}function _r(s){this.name="ExitStatus",this.message="Program terminated with exit("+s+")",this.status=s}function Jt(s){for(;s.length>0;)s.shift()(r)}function Ot(s){this.excPtr=s,this.ptr=s-24,this.set_type=function(a){ie[this.ptr+4>>2]=a},this.get_type=function(){return ie[this.ptr+4>>2]},this.set_destructor=function(a){ie[this.ptr+8>>2]=a},this.get_destructor=function(){return ie[this.ptr+8>>2]},this.set_refcount=function(a){ae[this.ptr>>2]=a},this.set_caught=function(a){a=a?1:0,le[this.ptr+12>>0]=a},this.get_caught=function(){return le[this.ptr+12>>0]!=0},this.set_rethrown=function(a){a=a?1:0,le[this.ptr+13>>0]=a},this.get_rethrown=function(){return le[this.ptr+13>>0]!=0},this.init=function(a,d){this.set_adjusted_ptr(0),this.set_type(a),this.set_destructor(d),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var a=ae[this.ptr>>2];ae[this.ptr>>2]=a+1},this.release_ref=function(){var a=ae[this.ptr>>2];return ae[this.ptr>>2]=a-1,a===1},this.set_adjusted_ptr=function(a){ie[this.ptr+16>>2]=a},this.get_adjusted_ptr=function(){return ie[this.ptr+16>>2]},this.get_exception_ptr=function(){var a=G(this.get_type());if(a)return ie[this.excPtr>>2];var d=this.get_adjusted_ptr();return d!==0?d:this.excPtr}}function Ir(s,a,d){var m=new Ot(s);throw m.init(a,d),s}var Me={};function Le(s){for(;s.length;){var a=s.pop(),d=s.pop();d(a)}}function ye(s){return this.fromWireType(ae[s>>2])}var Ve={},qe={},Be={},It=48,mr=57;function Xt(s){if(s===void 0)return"_unknown";s=s.replace(/[^a-zA-Z0-9_]/g,"$");var a=s.charCodeAt(0);return a>=It&&a<=mr?"_"+s:s}function Ut(s,a){return s=Xt(s),new Function("body","return function "+s+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(a)}function et(s,a){var d=Ut(a,function(m){this.name=a,this.message=m;var T=new Error(m).stack;T!==void 0&&(this.stack=this.toString()+`
`+T.replace(/^Error(:[^\n]*)?\n/,""))});return d.prototype=Object.create(s.prototype),d.prototype.constructor=d,d.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},d}var tt=void 0;function ct(s){throw new tt(s)}function Ie(s,a,d){s.forEach(function($){Be[$]=a});function m($){var n=d($);n.length!==s.length&&ct("Mismatched type converter count");for(var i=0;i<s.length;++i)Q(s[i],n[i])}var T=new Array(a.length),I=[],D=0;a.forEach(($,n)=>{qe.hasOwnProperty($)?T[n]=qe[$]:(I.push($),Ve.hasOwnProperty($)||(Ve[$]=[]),Ve[$].push(()=>{T[n]=qe[$],++D,D===I.length&&m(T)}))}),I.length===0&&m(T)}function Ue(s){var a=Me[s];delete Me[s];var d=a.rawConstructor,m=a.rawDestructor,T=a.fields,I=T.map(D=>D.getterReturnType).concat(T.map(D=>D.setterArgumentType));Ie([s],I,D=>{var $={};return T.forEach((n,i)=>{var e=n.fieldName,t=D[i],o=n.getter,c=n.getterContext,p=D[i+T.length],v=n.setter,g=n.setterContext;$[e]={read:_=>t.fromWireType(o(c,_)),write:(_,P)=>{var R=[];v(g,_,p.toWireType(R,P)),Le(R)}}}),[{name:a.name,fromWireType:function(n){var i={};for(var e in $)i[e]=$[e].read(n);return m(n),i},toWireType:function(n,i){for(var e in $)if(!(e in i))throw new TypeError('Missing field:  "'+e+'"');var t=d();for(e in $)$[e].write(t,i[e]);return n!==null&&n.push(m,t),t},argPackAdvance:8,readValueFromPointer:ye,destructorFunction:m}]})}function or(s,a,d,m,T){}function ar(s){switch(s){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+s)}}function Ae(){for(var s=new Array(256),a=0;a<256;++a)s[a]=String.fromCharCode(a);lt=s}var lt=void 0;function Y(s){for(var a="",d=s;ce[d];)a+=lt[ce[d++]];return a}var de=void 0;function re(s){throw new de(s)}function Q(s,a,d={}){if(!("argPackAdvance"in a))throw new TypeError("registerType registeredInstance requires argPackAdvance");var m=a.name;if(s||re('type "'+m+'" must have a positive integer typeid pointer'),qe.hasOwnProperty(s)){if(d.ignoreDuplicateRegistrations)return;re("Cannot register type '"+m+"' twice")}if(qe[s]=a,delete Be[s],Ve.hasOwnProperty(s)){var T=Ve[s];delete Ve[s],T.forEach(I=>I())}}function De(s,a,d,m,T){var I=ar(d);a=Y(a),Q(s,{name:a,fromWireType:function(D){return!!D},toWireType:function(D,$){return $?m:T},argPackAdvance:8,readValueFromPointer:function(D){var $;if(d===1)$=le;else if(d===2)$=fe;else if(d===4)$=ae;else throw new TypeError("Unknown boolean type size: "+a);return this.fromWireType($[D>>I])},destructorFunction:null})}function wr(s){if(!(this instanceof yt)||!(s instanceof yt))return!1;for(var a=this.$$.ptrType.registeredClass,d=this.$$.ptr,m=s.$$.ptrType.registeredClass,T=s.$$.ptr;a.baseClass;)d=a.upcast(d),a=a.baseClass;for(;m.baseClass;)T=m.upcast(T),m=m.baseClass;return a===m&&d===T}function br(s){return{count:s.count,deleteScheduled:s.deleteScheduled,preservePointerOnDelete:s.preservePointerOnDelete,ptr:s.ptr,ptrType:s.ptrType,smartPtr:s.smartPtr,smartPtrType:s.smartPtrType}}function jt(s){function a(d){return d.$$.ptrType.registeredClass.name}re(a(s)+" instance already deleted")}var Yt=!1;function xt(s){}function Re(s){s.smartPtr?s.smartPtrType.rawDestructor(s.smartPtr):s.ptrType.registeredClass.rawDestructor(s.ptr)}function Pt(s){s.count.value-=1;var a=s.count.value===0;a&&Re(s)}function se(s,a,d){if(a===d)return s;if(d.baseClass===void 0)return null;var m=se(s,a,d.baseClass);return m===null?null:d.downcast(m)}var rt={};function Wt(){return Object.keys(Ht).length}function Pr(){var s=[];for(var a in Ht)Ht.hasOwnProperty(a)&&s.push(Ht[a]);return s}var dt=[];function pt(){for(;dt.length;){var s=dt.pop();s.$$.deleteScheduled=!1,s.delete()}}var vt=void 0;function it(s){vt=s,dt.length&&vt&&vt(pt)}function rn(){r.getInheritedInstanceCount=Wt,r.getLiveInheritedInstances=Pr,r.flushPendingDeletes=pt,r.setDelayFunction=it}var Ht={};function ht(s,a){for(a===void 0&&re("ptr should not be undefined");s.baseClass;)a=s.upcast(a),s=s.baseClass;return a}function Ur(s,a){return a=ht(s,a),Ht[a]}function Tt(s,a){(!a.ptrType||!a.ptr)&&ct("makeClassHandle requires ptr and ptrType");var d=!!a.smartPtrType,m=!!a.smartPtr;return d!==m&&ct("Both smartPtrType and smartPtr must be specified"),a.count={value:1},gt(Object.create(s,{$$:{value:a}}))}function sr(s){var a=this.getPointee(s);if(!a)return this.destructor(s),null;var d=Ur(this.registeredClass,a);if(d!==void 0){if(d.$$.count.value===0)return d.$$.ptr=a,d.$$.smartPtr=s,d.clone();var m=d.clone();return this.destructor(s),m}function T(){return this.isSmartPointer?Tt(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:a,smartPtrType:this,smartPtr:s}):Tt(this.registeredClass.instancePrototype,{ptrType:this,ptr:s})}var I=this.registeredClass.getActualType(a),D=rt[I];if(!D)return T.call(this);var $;this.isConst?$=D.constPointerType:$=D.pointerType;var n=se(a,this.registeredClass,$.registeredClass);return n===null?T.call(this):this.isSmartPointer?Tt($.registeredClass.instancePrototype,{ptrType:$,ptr:n,smartPtrType:this,smartPtr:s}):Tt($.registeredClass.instancePrototype,{ptrType:$,ptr:n})}function gt(s){return typeof FinalizationRegistry>"u"?(gt=a=>a,s):(Yt=new FinalizationRegistry(a=>{Pt(a.$$)}),gt=a=>{var d=a.$$,m=!!d.smartPtr;if(m){var T={$$:d};Yt.register(a,T,a)}return a},xt=a=>Yt.unregister(a),gt(s))}function Et(){if(this.$$.ptr||jt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var s=gt(Object.create(Object.getPrototypeOf(this),{$$:{value:br(this.$$)}}));return s.$$.count.value+=1,s.$$.deleteScheduled=!1,s}function Kt(){this.$$.ptr||jt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&re("Object already scheduled for deletion"),xt(this),Pt(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function nn(){return!this.$$.ptr}function Ct(){return this.$$.ptr||jt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&re("Object already scheduled for deletion"),dt.push(this),dt.length===1&&vt&&vt(pt),this.$$.deleteScheduled=!0,this}function Mt(){yt.prototype.isAliasOf=wr,yt.prototype.clone=Et,yt.prototype.delete=Kt,yt.prototype.isDeleted=nn,yt.prototype.deleteLater=Ct}function yt(){}function _t(s,a,d){if(s[a].overloadTable===void 0){var m=s[a];s[a]=function(){return s[a].overloadTable.hasOwnProperty(arguments.length)||re("Function '"+d+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+s[a].overloadTable+")!"),s[a].overloadTable[arguments.length].apply(this,arguments)},s[a].overloadTable=[],s[a].overloadTable[m.argCount]=m}}function St(s,a,d){r.hasOwnProperty(s)?(re("Cannot register public name '"+s+"' twice"),_t(r,s,s),r.hasOwnProperty(d)&&re("Cannot register multiple overloads of a function with the same number of arguments ("+d+")!"),r[s].overloadTable[d]=a):r[s]=a}function on(s,a,d,m,T,I,D,$){this.name=s,this.constructor=a,this.instancePrototype=d,this.rawDestructor=m,this.baseClass=T,this.getActualType=I,this.upcast=D,this.downcast=$,this.pureVirtualFunctions=[]}function kt(s,a,d){for(;a!==d;)a.upcast||re("Expected null or instance of "+d.name+", got an instance of "+a.name),s=a.upcast(s),a=a.baseClass;return s}function Tr(s,a){if(a===null)return this.isReference&&re("null is not a valid "+this.name),0;a.$$||re('Cannot pass "'+er(a)+'" as a '+this.name),a.$$.ptr||re("Cannot pass deleted object as a pointer of type "+this.name);var d=a.$$.ptrType.registeredClass,m=kt(a.$$.ptr,d,this.registeredClass);return m}function an(s,a){var d;if(a===null)return this.isReference&&re("null is not a valid "+this.name),this.isSmartPointer?(d=this.rawConstructor(),s!==null&&s.push(this.rawDestructor,d),d):0;a.$$||re('Cannot pass "'+er(a)+'" as a '+this.name),a.$$.ptr||re("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&a.$$.ptrType.isConst&&re("Cannot convert argument of type "+(a.$$.smartPtrType?a.$$.smartPtrType.name:a.$$.ptrType.name)+" to parameter type "+this.name);var m=a.$$.ptrType.registeredClass;if(d=kt(a.$$.ptr,m,this.registeredClass),this.isSmartPointer)switch(a.$$.smartPtr===void 0&&re("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:a.$$.smartPtrType===this?d=a.$$.smartPtr:re("Cannot convert argument of type "+(a.$$.smartPtrType?a.$$.smartPtrType.name:a.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:d=a.$$.smartPtr;break;case 2:if(a.$$.smartPtrType===this)d=a.$$.smartPtr;else{var T=a.clone();d=this.rawShare(d,at.toHandle(function(){T.delete()})),s!==null&&s.push(this.rawDestructor,d)}break;default:re("Unsupporting sharing policy")}return d}function sn(s,a){if(a===null)return this.isReference&&re("null is not a valid "+this.name),0;a.$$||re('Cannot pass "'+er(a)+'" as a '+this.name),a.$$.ptr||re("Cannot pass deleted object as a pointer of type "+this.name),a.$$.ptrType.isConst&&re("Cannot convert argument of type "+a.$$.ptrType.name+" to parameter type "+this.name);var d=a.$$.ptrType.registeredClass,m=kt(a.$$.ptr,d,this.registeredClass);return m}function un(s){return this.rawGetPointee&&(s=this.rawGetPointee(s)),s}function fn(s){this.rawDestructor&&this.rawDestructor(s)}function Se(s){s!==null&&s.delete()}function Cr(){ot.prototype.getPointee=un,ot.prototype.destructor=fn,ot.prototype.argPackAdvance=8,ot.prototype.readValueFromPointer=ye,ot.prototype.deleteObject=Se,ot.prototype.fromWireType=sr}function ot(s,a,d,m,T,I,D,$,n,i,e){this.name=s,this.registeredClass=a,this.isReference=d,this.isConst=m,this.isSmartPointer=T,this.pointeeType=I,this.sharingPolicy=D,this.rawGetPointee=$,this.rawConstructor=n,this.rawShare=i,this.rawDestructor=e,!T&&a.baseClass===void 0?m?(this.toWireType=Tr,this.destructorFunction=null):(this.toWireType=sn,this.destructorFunction=null):this.toWireType=an}function Ge(s,a,d){r.hasOwnProperty(s)||ct("Replacing nonexistant public symbol"),r[s].overloadTable!==void 0&&d!==void 0||(r[s]=a,r[s].argCount=d)}function ur(s,a,d){var m=r["dynCall_"+s];return d&&d.length?m.apply(null,[a].concat(d)):m.call(null,a)}var fr=[];function Qt(s){var a=fr[s];return a||(s>=fr.length&&(fr.length=s+1),fr[s]=a=zt.get(s)),a}function Ee(s,a,d){if(s.includes("j"))return ur(s,a,d);var m=Qt(a).apply(null,d);return m}function jr(s,a){var d=[];return function(){return d.length=0,Object.assign(d,arguments),Ee(s,a,d)}}function nt(s,a){s=Y(s);function d(){return s.includes("j")?jr(s,a):Qt(a)}var m=d();return typeof m!="function"&&re("unknown function pointer with signature "+s+": "+a),m}var je=void 0;function Ar(s){var a=F(s),d=Y(a);return k(a),d}function xe(s,a){var d=[],m={};function T(I){if(!m[I]&&!qe[I]){if(Be[I]){Be[I].forEach(T);return}d.push(I),m[I]=!0}}throw a.forEach(T),new je(s+": "+d.map(Ar).join([", "]))}function cr(s,a,d,m,T,I,D,$,n,i,e,t,o){e=Y(e),I=nt(T,I),$&&($=nt(D,$)),i&&(i=nt(n,i)),o=nt(t,o);var c=Xt(e);St(c,function(){xe("Cannot construct "+e+" due to unbound types",[m])}),Ie([s,a,d],m?[m]:[],function(p){p=p[0];var v,g;m?(v=p.registeredClass,g=v.instancePrototype):g=yt.prototype;var _=Ut(c,function(){if(Object.getPrototypeOf(this)!==P)throw new de("Use 'new' to construct "+e);if(R.constructor_body===void 0)throw new de(e+" has no accessible constructor");var te=R.constructor_body[arguments.length];if(te===void 0)throw new de("Tried to invoke ctor of "+e+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(R.constructor_body).toString()+") parameters instead!");return te.apply(this,arguments)}),P=Object.create(g,{constructor:{value:_}});_.prototype=P;var R=new on(e,_,P,o,v,I,$,i),U=new ot(e,R,!0,!1,!1),B=new ot(e+"*",R,!1,!1,!1),V=new ot(e+" const*",R,!1,!0,!1);return rt[s]={pointerType:B,constPointerType:V},Ge(c,_),[U,B,V]})}function lr(s,a){for(var d=[],m=0;m<s;m++)d.push(ie[a+m*4>>2]);return d}function xr(s,a){if(!(s instanceof Function))throw new TypeError("new_ called with constructor type "+typeof s+" which is not a function");var d=Ut(s.name||"unknownFunctionName",function(){});d.prototype=s.prototype;var m=new d,T=s.apply(m,a);return T instanceof Object?T:m}function Wr(s,a,d,m,T){var I=a.length;I<2&&re("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var D=a[1]!==null&&d!==null,$=!1,n=1;n<a.length;++n)if(a[n]!==null&&a[n].destructorFunction===void 0){$=!0;break}for(var i=a[0].name!=="void",e="",t="",n=0;n<I-2;++n)e+=(n!==0?", ":"")+"arg"+n,t+=(n!==0?", ":"")+"arg"+n+"Wired";var o="return function "+Xt(s)+"("+e+`) {
if (arguments.length !== `+(I-2)+`) {
throwBindingError('function `+s+" called with ' + arguments.length + ' arguments, expected "+(I-2)+` args!');
}
`;$&&(o+=`var destructors = [];
`);var c=$?"destructors":"null",p=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],v=[re,m,T,Le,a[0],a[1]];D&&(o+="var thisWired = classParam.toWireType("+c+`, this);
`);for(var n=0;n<I-2;++n)o+="var arg"+n+"Wired = argType"+n+".toWireType("+c+", arg"+n+"); // "+a[n+2].name+`
`,p.push("argType"+n),v.push(a[n+2]);if(D&&(t="thisWired"+(t.length>0?", ":"")+t),o+=(i?"var rv = ":"")+"invoker(fn"+(t.length>0?", ":"")+t+`);
`,$)o+=`runDestructors(destructors);
`;else for(var n=D?1:2;n<a.length;++n){var g=n===1?"thisWired":"arg"+(n-2)+"Wired";a[n].destructorFunction!==null&&(o+=g+"_dtor("+g+"); // "+a[n].name+`
`,p.push(g+"_dtor"),v.push(a[n].destructorFunction))}i&&(o+=`var ret = retType.fromWireType(rv);
return ret;
`),o+=`}
`,p.push(o);var _=xr(Function,p).apply(null,v);return _}function We(s,a,d,m,T,I){wt(a>0);var D=lr(a,d);T=nt(m,T),Ie([],[s],function($){$=$[0];var n="constructor "+$.name;if($.registeredClass.constructor_body===void 0&&($.registeredClass.constructor_body=[]),$.registeredClass.constructor_body[a-1]!==void 0)throw new de("Cannot register multiple constructors with identical number of parameters ("+(a-1)+") for class '"+$.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return $.registeredClass.constructor_body[a-1]=()=>{xe("Cannot construct "+$.name+" due to unbound types",D)},Ie([],D,function(i){return i.splice(1,0,null),$.registeredClass.constructor_body[a-1]=Wr(n,i,null,T,I),[]}),[]})}function Je(s,a,d,m,T,I,D,$){var n=lr(d,m);a=Y(a),I=nt(T,I),Ie([],[s],function(i){i=i[0];var e=i.name+"."+a;a.startsWith("@@")&&(a=Symbol[a.substring(2)]),$&&i.registeredClass.pureVirtualFunctions.push(a);function t(){xe("Cannot call "+e+" due to unbound types",n)}var o=i.registeredClass.instancePrototype,c=o[a];return c===void 0||c.overloadTable===void 0&&c.className!==i.name&&c.argCount===d-2?(t.argCount=d-2,t.className=i.name,o[a]=t):(_t(o,a,e),o[a].overloadTable[d-2]=t),Ie([],n,function(p){var v=Wr(e,p,i,I,D);return o[a].overloadTable===void 0?(v.argCount=d-2,o[a]=v):o[a].overloadTable[d-2]=v,[]}),[]})}var Zt=[],ke=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Xe(s){s>4&&--ke[s].refcount===0&&(ke[s]=void 0,Zt.push(s))}function dr(){for(var s=0,a=5;a<ke.length;++a)ke[a]!==void 0&&++s;return s}function At(){for(var s=5;s<ke.length;++s)if(ke[s]!==void 0)return ke[s];return null}function $r(){r.count_emval_handles=dr,r.get_first_emval=At}var at={toValue:s=>(s||re("Cannot use deleted val. handle = "+s),ke[s].value),toHandle:s=>{switch(s){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var a=Zt.length?Zt.pop():ke.length;return ke[a]={refcount:1,value:s},a}}}};function $t(s,a){a=Y(a),Q(s,{name:a,fromWireType:function(d){var m=at.toValue(d);return Xe(d),m},toWireType:function(d,m){return at.toHandle(m)},argPackAdvance:8,readValueFromPointer:ye,destructorFunction:null})}function er(s){if(s===null)return"null";var a=typeof s;return a==="object"||a==="array"||a==="function"?s.toString():""+s}function Ne(s,a){switch(a){case 2:return function(d){return this.fromWireType(he[d>>2])};case 3:return function(d){return this.fromWireType(Bt[d>>3])};default:throw new TypeError("Unknown float type: "+s)}}function Hr(s,a,d){var m=ar(d);a=Y(a),Q(s,{name:a,fromWireType:function(T){return T},toWireType:function(T,I){return I},argPackAdvance:8,readValueFromPointer:Ne(a,m),destructorFunction:null})}function cn(s,a,d){switch(a){case 0:return d?function(T){return le[T]}:function(T){return ce[T]};case 1:return d?function(T){return fe[T>>1]}:function(T){return ne[T>>1]};case 2:return d?function(T){return ae[T>>2]}:function(T){return ie[T>>2]};default:throw new TypeError("Unknown integer type: "+s)}}function ln(s,a,d,m,T){a=Y(a);var I=ar(d),D=t=>t;if(m===0){var $=32-8*d;D=t=>t<<$>>>$}var n=a.includes("unsigned"),i=(t,o)=>{},e;n?e=function(t,o){return i(o,this.name),o>>>0}:e=function(t,o){return i(o,this.name),o},Q(s,{name:a,fromWireType:D,toWireType:e,argPackAdvance:8,readValueFromPointer:cn(a,I,m!==0),destructorFunction:null})}function dn(s,a,d){var m=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],T=m[a];function I(D){D=D>>2;var $=ie,n=$[D],i=$[D+1];return new T(me,i,n)}d=Y(d),Q(s,{name:d,fromWireType:I,argPackAdvance:8,readValueFromPointer:I},{ignoreDuplicateRegistrations:!0})}function tr(s,a){a=Y(a);var d=a==="std::string";Q(s,{name:a,fromWireType:function(m){var T=ie[m>>2],I=m+4,D;if(d)for(var $=I,n=0;n<=T;++n){var i=I+n;if(n==T||ce[i]==0){var e=i-$,t=rr($,e);D===void 0?D=t:(D+="\0",D+=t),$=i+1}}else{for(var o=new Array(T),n=0;n<T;++n)o[n]=String.fromCharCode(ce[I+n]);D=o.join("")}return k(m),D},toWireType:function(m,T){T instanceof ArrayBuffer&&(T=new Uint8Array(T));var I,D=typeof T=="string";D||T instanceof Uint8Array||T instanceof Uint8ClampedArray||T instanceof Int8Array||re("Cannot pass non-string to std::string"),d&&D?I=Ye(T):I=T.length;var $=C(4+I+1),n=$+4;if(ie[$>>2]=I,d&&D)nr(T,n,I+1);else if(D)for(var i=0;i<I;++i){var e=T.charCodeAt(i);e>255&&(k(n),re("String has UTF-16 code units that do not fit in 8 bits")),ce[n+i]=e}else for(var i=0;i<I;++i)ce[n+i]=T[i];return m!==null&&m.push(k,$),$},argPackAdvance:8,readValueFromPointer:ye,destructorFunction:function(m){k(m)}})}var Mr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function pr(s,a){for(var d=s,m=d>>1,T=m+a/2;!(m>=T)&&ne[m];)++m;if(d=m<<1,d-s>32&&Mr)return Mr.decode(ce.subarray(s,d));for(var I="",D=0;!(D>=a/2);++D){var $=fe[s+D*2>>1];if($==0)break;I+=String.fromCharCode($)}return I}function pn(s,a,d){if(d===void 0&&(d=2147483647),d<2)return 0;d-=2;for(var m=a,T=d<s.length*2?d/2:s.length,I=0;I<T;++I){var D=s.charCodeAt(I);fe[a>>1]=D,a+=2}return fe[a>>1]=0,a-m}function vn(s){return s.length*2}function hn(s,a){for(var d=0,m="";!(d>=a/4);){var T=ae[s+d*4>>2];if(T==0)break;if(++d,T>=65536){var I=T-65536;m+=String.fromCharCode(55296|I>>10,56320|I&1023)}else m+=String.fromCharCode(T)}return m}function gn(s,a,d){if(d===void 0&&(d=2147483647),d<4)return 0;for(var m=a,T=m+d-4,I=0;I<s.length;++I){var D=s.charCodeAt(I);if(D>=55296&&D<=57343){var $=s.charCodeAt(++I);D=65536+((D&1023)<<10)|$&1023}if(ae[a>>2]=D,a+=4,a+4>T)break}return ae[a>>2]=0,a-m}function yn(s){for(var a=0,d=0;d<s.length;++d){var m=s.charCodeAt(d);m>=55296&&m<=57343&&++d,a+=4}return a}function _n(s,a,d){d=Y(d);var m,T,I,D,$;a===2?(m=pr,T=pn,D=vn,I=()=>ne,$=1):a===4&&(m=hn,T=gn,D=yn,I=()=>ie,$=2),Q(s,{name:d,fromWireType:function(n){for(var i=ie[n>>2],e=I(),t,o=n+4,c=0;c<=i;++c){var p=n+4+c*a;if(c==i||e[p>>$]==0){var v=p-o,g=m(o,v);t===void 0?t=g:(t+="\0",t+=g),o=p+a}}return k(n),t},toWireType:function(n,i){typeof i!="string"&&re("Cannot pass non-string to C++ string type "+d);var e=D(i),t=C(4+e+a);return ie[t>>2]=e>>$,T(i,t+4,e+a),n!==null&&n.push(k,t),t},argPackAdvance:8,readValueFromPointer:ye,destructorFunction:function(n){k(n)}})}function mn(s,a,d,m,T,I){Me[s]={name:Y(a),rawConstructor:nt(d,m),rawDestructor:nt(T,I),fields:[]}}function Lr(s,a,d,m,T,I,D,$,n,i){Me[s].fields.push({fieldName:Y(a),getterReturnType:d,getter:nt(m,T),getterContext:I,setterArgumentType:D,setter:nt($,n),setterContext:i})}function wn(s,a){a=Y(a),Q(s,{isVoid:!0,name:a,argPackAdvance:0,fromWireType:function(){},toWireType:function(d,m){}})}var bn={};function Vr(s){var a=bn[s];return a===void 0?Y(s):a}function Br(){return typeof globalThis=="object"?globalThis:function(){return Function}()("return this")()}function Pn(s){return s===0?at.toHandle(Br()):(s=Vr(s),at.toHandle(Br()[s]))}function Rr(s){s>4&&(ke[s].refcount+=1)}function Nr(s,a){var d=qe[s];return d===void 0&&re(a+" has unknown type "+Ar(s)),d}function zr(s){for(var a="",d=0;d<s;++d)a+=(d!==0?", ":"")+"arg"+d;for(var m=()=>ie,T="return function emval_allocator_"+s+`(constructor, argTypes, args) {
  var HEAPU32 = getMemory();
`,d=0;d<s;++d)T+="var argType"+d+" = requireRegisteredType(HEAPU32[((argTypes)>>2)], 'parameter "+d+`');
var arg`+d+" = argType"+d+`.readValueFromPointer(args);
args += argType`+d+`['argPackAdvance'];
argTypes += 4;
`;return T+="var obj = new constructor("+a+`);
return valueToHandle(obj);
}
`,new Function("requireRegisteredType","Module","valueToHandle","getMemory",T)(Nr,r,at.toHandle,m)}var Er={};function Tn(s,a,d,m){s=at.toValue(s);var T=Er[a];return T||(T=zr(a),Er[a]=T),T(s,d,m)}function qr(s,a){s=Nr(s,"_emval_take_value");var d=s.readValueFromPointer(a);return at.toHandle(d)}function Cn(){Dt("")}function Gr(){return 2147483648}function An(){return Gr()}function $n(s,a,d){ce.copyWithin(s,a,a+d)}function Rn(s){try{return Pe.grow(s-me.byteLength+65535>>>16),Nt(Pe.buffer),1}catch{}}function En(s){var a=ce.length;s=s>>>0;var d=Gr();if(s>d)return!1;let m=(n,i)=>n+(i-n%i)%i;for(var T=1;T<=4;T*=2){var I=a*(1+.2/T);I=Math.min(I,s+100663296);var D=Math.min(d,m(Math.max(s,I),65536)),$=Rn(D);if($)return!0}return!1}var Sr={};function kr(){return N||"./this.program"}function Ft(){if(!Ft.strings){var s=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",a={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:s,_:kr()};for(var d in Sr)Sr[d]===void 0?delete a[d]:a[d]=Sr[d];var m=[];for(var d in a)m.push(d+"="+a[d]);Ft.strings=m}return Ft.strings}function Lt(s,a,d){for(var m=0;m<s.length;++m)le[a++>>0]=s.charCodeAt(m);le[a>>0]=0}function mt(s,a){var d=0;return Ft().forEach(function(m,T){var I=a+d;ie[s+T*4>>2]=I,Lt(m,I),d+=m.length+1}),0}function Jr(s,a){var d=Ft();ie[s>>2]=d.length;var m=0;return d.forEach(function(T){m+=T.length+1}),ie[a>>2]=m,0}function Xr(s){return 52}function Fr(s,a,d,m,T){return 70}var Yr=[null,[],[]];function vr(s,a){var d=Yr[s];a===0||a===10?((s===1?_e:oe)(bt(d,0)),d.length=0):d.push(a)}function Kr(s,a,d,m){for(var T=0,I=0;I<d;I++){var D=ie[a>>2],$=ie[a+4>>2];a+=8;for(var n=0;n<$;n++)vr(s,ce[D+n]);T+=$}return ie[m>>2]=T,0}function u(s){var a=r["_"+s];return a}function f(s,a){le.set(s,a)}function h(s,a,d,m,T){var I={string:p=>{var v=0;if(p!=null&&p!==0){var g=(p.length<<2)+1;v=j(g),nr(p,v,g)}return v},array:p=>{var v=j(p.length);return f(p,v),v}};function D(p){return a==="string"?rr(p):a==="boolean"?!!p:p}var $=u(s),n=[],i=0;if(m)for(var e=0;e<m.length;e++){var t=I[d[e]];t?(i===0&&(i=A()),n[e]=t(m[e])):n[e]=m[e]}var o=$.apply(null,n);function c(p){return i!==0&&O(i),D(p)}return o=c(o),o}tt=r.InternalError=et(Error,"InternalError"),Ae(),de=r.BindingError=et(Error,"BindingError"),Mt(),rn(),Cr(),je=r.UnboundTypeError=et(Error,"UnboundTypeError"),$r();var b={D:Ir,e:Ue,t:or,B:De,r:cr,q:We,b:Je,A:$t,l:Hr,d:ln,a:dn,k:tr,f:_n,g:mn,c:Lr,C:wn,h:Xe,o:Pn,m:Rr,n:Tn,p:qr,i:Cn,v:An,z:$n,u:En,w:mt,x:Jr,y:Xr,s:Fr,j:Kr};yr(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.F).apply(null,arguments)};var C=r._malloc=function(){return(C=r._malloc=r.asm.H).apply(null,arguments)},k=r._free=function(){return(k=r._free=r.asm.I).apply(null,arguments)},F=r.___getTypeName=function(){return(F=r.___getTypeName=r.asm.J).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.K).apply(null,arguments)};var A=r.stackSave=function(){return(A=r.stackSave=r.asm.L).apply(null,arguments)},O=r.stackRestore=function(){return(O=r.stackRestore=r.asm.M).apply(null,arguments)},j=r.stackAlloc=function(){return(j=r.stackAlloc=r.asm.N).apply(null,arguments)},G=r.___cxa_is_pointer_type=function(){return(G=r.___cxa_is_pointer_type=r.asm.O).apply(null,arguments)};r.dynCall_iji=function(){return(r.dynCall_iji=r.asm.P).apply(null,arguments)},r.dynCall_jji=function(){return(r.dynCall_jji=r.asm.Q).apply(null,arguments)},r.dynCall_iiji=function(){return(r.dynCall_iiji=r.asm.R).apply(null,arguments)},r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.S).apply(null,arguments)},r.ccall=h;var J;Ze=function s(){J||K(),J||(Ze=s)};function K(s){if(Qe>0||(Dr(),Qe>0))return;function a(){J||(J=!0,r.calledRun=!0,!ze&&(Zr(),x(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),en()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),a()},1)):a()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return K(),E.ready}})();l.exports=w})(li);var to=li.exports,ro=zn(to);const no=new URL("/dicom-viewer/assets/openjpegwasm_decode-C4nnCcr6.wasm",import.meta.url),In={codec:void 0,decoder:void 0,decodeConfig:{}};function io(l){if(In.decodeConfig=l,In.codec)return Promise.resolve();const y=ro({locateFile:w=>w.endsWith(".wasm")?no.toString():w});return new Promise((w,S)=>{y.then(E=>{In.codec=E,In.decoder=new E.J2KDecoder,w()},S)})}async function ti(l,y){await io();const w=In.decoder,S=w.getEncodedBuffer(l.length);S.set(l),w.decode();const E=w.getFrameInfo(),r=w.getDecodedBuffer();new Uint8Array(r.length).set(r);const W=`x: ${w.getImageOffset().x}, y: ${w.getImageOffset().y}`,H=w.getNumDecompositions(),N=w.getNumLayers(),L=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][w.getProgressionOrder()+1],z=w.getIsReversible(),M=`${w.getBlockDimensions().width} x ${w.getBlockDimensions().height}`,X=`${w.getTileSize().width} x ${w.getTileSize().height}`,q=`${w.getTileOffset().x}, ${w.getTileOffset().y}`,Z=w.getColorSpace(),ue=`${r.length.toLocaleString()} bytes`,$e=`${(r.length/S.length).toFixed(2)}:1`,pe={columns:E.width,rows:E.height,bitsPerPixel:E.bitsPerSample,signed:E.isSigned,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:E.componentCount},we=oo(E,r),_e={imageOffset:W,numDecompositions:H,numLayers:N,progessionOrder:L,reversible:z,blockDimensions:M,tileSize:X,tileOffset:q,colorTransform:Z,decodedSize:ue,compressionRatio:$e};return{...y,pixelData:we,imageInfo:pe,encodeOptions:_e,..._e,...pe}}function oo(l,y){return l.bitsPerSample>8?l.isSigned?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):l.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}var di={exports:{}};(function(l,y){var w=(()=>{var S=typeof document<"u"&&document.currentScript?document.currentScript.src:void 0;return typeof __filename<"u"&&(S=S||__filename),function(r){r=r||{};var r=typeof r<"u"?r:{},x,W;r.ready=new Promise(function(n,i){x=n,W=i});var H=Object.assign({},r),N=typeof window=="object",L=typeof importScripts=="function",z=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",M="";function X(n){return r.locateFile?r.locateFile(n,M):M+n}var q,Z,ue;if(z){var $e=Qr,pe=Qr;L?M=pe.dirname(M)+"/":M=__dirname+"/",q=(n,i)=>(n=Te(n)?new URL(n):pe.normalize(n),$e.readFileSync(n,i?void 0:"utf8")),ue=n=>{var i=q(n,!0);return i.buffer||(i=new Uint8Array(i)),i},Z=(n,i,e)=>{n=Te(n)?new URL(n):pe.normalize(n),$e.readFile(n,function(t,o){t?e(t):i(o.buffer)})},process.argv.length>1&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(n){if(!(n instanceof yr))throw n}),process.on("unhandledRejection",function(n){throw n}),r.inspect=function(){return"[Emscripten Module object]"}}else(N||L)&&(L?M=self.location.href:typeof document<"u"&&document.currentScript&&(M=document.currentScript.src),S&&(M=S),M.indexOf("blob:")!==0?M=M.substr(0,M.replace(/[?#].*/,"").lastIndexOf("/")+1):M="",q=n=>{var i=new XMLHttpRequest;return i.open("GET",n,!1),i.send(null),i.responseText},L&&(ue=n=>{var i=new XMLHttpRequest;return i.open("GET",n,!1),i.responseType="arraybuffer",i.send(null),new Uint8Array(i.response)}),Z=(n,i,e)=>{var t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="arraybuffer",t.onload=()=>{if(t.status==200||t.status==0&&t.response){i(t.response);return}e()},t.onerror=e,t.send(null)});var we=r.print||console.log.bind(console),_e=r.printErr||console.warn.bind(console);Object.assign(r,H),H=null,r.arguments&&r.arguments,r.thisProgram&&r.thisProgram,r.quit&&r.quit;var oe;r.wasmBinary&&(oe=r.wasmBinary),r.noExitRuntime,typeof WebAssembly!="object"&&Gt("no native wasm support detected");var ge,Pe=!1;function ze(n,i){n||Gt(i)}var wt=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function st(n,i,e){for(var t=i+e,o=i;n[o]&&!(o>=t);)++o;if(o-i>16&&n.buffer&&wt)return wt.decode(n.subarray(i,o));for(var c="";i<o;){var p=n[i++];if(!(p&128)){c+=String.fromCharCode(p);continue}var v=n[i++]&63;if((p&224)==192){c+=String.fromCharCode((p&31)<<6|v);continue}var g=n[i++]&63;if((p&240)==224?p=(p&15)<<12|v<<6|g:p=(p&7)<<18|v<<12|g<<6|n[i++]&63,p<65536)c+=String.fromCharCode(p);else{var _=p-65536;c+=String.fromCharCode(55296|_>>10,56320|_&1023)}}return c}function bt(n,i){return n?st(le,n,i):""}function rr(n,i,e,t){if(!(t>0))return 0;for(var o=e,c=e+t-1,p=0;p<n.length;++p){var v=n.charCodeAt(p);if(v>=55296&&v<=57343){var g=n.charCodeAt(++p);v=65536+((v&1023)<<10)|g&1023}if(v<=127){if(e>=c)break;i[e++]=v}else if(v<=2047){if(e+1>=c)break;i[e++]=192|v>>6,i[e++]=128|v&63}else if(v<=65535){if(e+2>=c)break;i[e++]=224|v>>12,i[e++]=128|v>>6&63,i[e++]=128|v&63}else{if(e+3>=c)break;i[e++]=240|v>>18,i[e++]=128|v>>12&63,i[e++]=128|v>>6&63,i[e++]=128|v&63}}return i[e]=0,e-o}function hr(n,i,e){return rr(n,le,i,e)}function nr(n){for(var i=0,e=0;e<n.length;++e){var t=n.charCodeAt(e);t<=127?i++:t<=2047?i+=2:t>=55296&&t<=57343?(i+=4,++e):i+=3}return i}var Ye,me,le,ce,fe,ne,ae,ie,he;function Bt(n){Ye=n,r.HEAP8=me=new Int8Array(n),r.HEAP16=ce=new Int16Array(n),r.HEAP32=ne=new Int32Array(n),r.HEAPU8=le=new Uint8Array(n),r.HEAPU16=fe=new Uint16Array(n),r.HEAPU32=ae=new Uint32Array(n),r.HEAPF32=ie=new Float32Array(n),r.HEAPF64=he=new Float64Array(n)}r.INITIAL_MEMORY;var Nt,zt=[],qt=[],ir=[];function gr(){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;)en(r.preRun.shift());_r(zt)}function Dr(){_r(qt)}function Zr(){if(r.postRun)for(typeof r.postRun=="function"&&(r.postRun=[r.postRun]);r.postRun.length;)Rt(r.postRun.shift());_r(ir)}function en(n){zt.unshift(n)}function tn(n){qt.unshift(n)}function Rt(n){ir.unshift(n)}var Ke=0,Qe=null;function Ze(n){Ke++,r.monitorRunDependencies&&r.monitorRunDependencies(Ke)}function ut(n){if(Ke--,r.monitorRunDependencies&&r.monitorRunDependencies(Ke),Ke==0&&Qe){var i=Qe;Qe=null,i()}}function Gt(n){r.onAbort&&r.onAbort(n),n="Aborted("+n+")",_e(n),Pe=!0,n+=". Build with -sASSERTIONS for more info.";var i=new WebAssembly.RuntimeError(n);throw W(i),i}var Dt="data:application/octet-stream;base64,";function ft(n){return n.startsWith(Dt)}function Te(n){return n.startsWith("file://")}var be;be="openjphjs.wasm",ft(be)||(be=X(be));function Ce(n){try{if(n==be&&oe)return new Uint8Array(oe);if(ue)return ue(n);throw"both async and sync fetching of the wasm failed"}catch(i){Gt(i)}}function Fe(){if(!oe&&(N||L)){if(typeof fetch=="function"&&!Te(be))return fetch(be,{credentials:"same-origin"}).then(function(n){if(!n.ok)throw"failed to load wasm binary file at '"+be+"'";return n.arrayBuffer()}).catch(function(){return Ce(be)});if(Z)return new Promise(function(n,i){Z(be,function(e){n(new Uint8Array(e))},i)})}return Promise.resolve().then(function(){return Ce(be)})}function Or(){var n={a:Kr};function i(p,v){var g=p.exports;r.asm=g,ge=r.asm.P,Bt(ge.buffer),Nt=r.asm.T,tn(r.asm.Q),ut()}Ze();function e(p){i(p.instance)}function t(p){return Fe().then(function(v){return WebAssembly.instantiate(v,n)}).then(function(v){return v}).then(p,function(v){_e("failed to asynchronously prepare wasm: "+v),Gt(v)})}function o(){return!oe&&typeof WebAssembly.instantiateStreaming=="function"&&!ft(be)&&!Te(be)&&!z&&typeof fetch=="function"?fetch(be,{credentials:"same-origin"}).then(function(p){var v=WebAssembly.instantiateStreaming(p,n);return v.then(e,function(g){return _e("wasm streaming compile failed: "+g),_e("falling back to ArrayBuffer instantiation"),t(e)})}):t(e)}if(r.instantiateWasm)try{var c=r.instantiateWasm(n,i);return c}catch(p){_e("Module.instantiateWasm callback failed with error: "+p),W(p)}return o().catch(W),{}}function yr(n){this.name="ExitStatus",this.message="Program terminated with exit("+n+")",this.status=n}function _r(n){for(;n.length>0;)n.shift()(r)}var Jt=[];function Ot(n){n.add_ref()}function Ir(n){var i=new Be(n);return i.get_caught()||i.set_caught(!0),i.set_rethrown(!1),Jt.push(i),Ot(i),i.get_exception_ptr()}var Me=0,Le=[];function ye(n){var i=Le[n];return i||(n>=Le.length&&(Le.length=n+1),Le[n]=i=Nt.get(n)),i}function Ve(n){if(n.release_ref()&&!n.get_rethrown()){var i=n.get_destructor();i&&ye(i)(n.excPtr),f(n.excPtr)}}function qe(){_setThrew(0);var n=Jt.pop();Ve(n),Me=0}function Be(n){this.excPtr=n,this.ptr=n-24,this.set_type=function(i){ae[this.ptr+4>>2]=i},this.get_type=function(){return ae[this.ptr+4>>2]},this.set_destructor=function(i){ae[this.ptr+8>>2]=i},this.get_destructor=function(){return ae[this.ptr+8>>2]},this.set_refcount=function(i){ne[this.ptr>>2]=i},this.set_caught=function(i){i=i?1:0,me[this.ptr+12>>0]=i},this.get_caught=function(){return me[this.ptr+12>>0]!=0},this.set_rethrown=function(i){i=i?1:0,me[this.ptr+13>>0]=i},this.get_rethrown=function(){return me[this.ptr+13>>0]!=0},this.init=function(i,e){this.set_adjusted_ptr(0),this.set_type(i),this.set_destructor(e),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var i=ne[this.ptr>>2];ne[this.ptr>>2]=i+1},this.release_ref=function(){var i=ne[this.ptr>>2];return ne[this.ptr>>2]=i-1,i===1},this.set_adjusted_ptr=function(i){ae[this.ptr+16>>2]=i},this.get_adjusted_ptr=function(){return ae[this.ptr+16>>2]},this.get_exception_ptr=function(){var i=j(this.get_type());if(i)return ae[this.excPtr>>2];var e=this.get_adjusted_ptr();return e!==0?e:this.excPtr}}function It(n){throw Me||(Me=n),n}function mr(){var n=Me;if(!n)return C(0),0;var i=new Be(n);i.set_adjusted_ptr(n);var e=i.get_type();if(!e)return C(0),n;for(var t=0;t<arguments.length;t++){var o=arguments[t];if(o===0||o===e)break;var c=i.ptr+16;if(O(o,e,c))return C(o),n}return C(e),n}function Xt(){var n=Me;if(!n)return C(0),0;var i=new Be(n);i.set_adjusted_ptr(n);var e=i.get_type();if(!e)return C(0),n;for(var t=0;t<arguments.length;t++){var o=arguments[t];if(o===0||o===e)break;var c=i.ptr+16;if(O(o,e,c))return C(o),n}return C(e),n}function Ut(n,i,e){var t=new Be(n);throw t.init(i,e),Me=n,n}var et={};function tt(n){for(;n.length;){var i=n.pop(),e=n.pop();e(i)}}function ct(n){return this.fromWireType(ne[n>>2])}var Ie={},Ue={},or={},ar=48,Ae=57;function lt(n){if(n===void 0)return"_unknown";n=n.replace(/[^a-zA-Z0-9_]/g,"$");var i=n.charCodeAt(0);return i>=ar&&i<=Ae?"_"+n:n}function Y(n,i){return n=lt(n),new Function("body","return function "+n+`() {
    "use strict";    return body.apply(this, arguments);
};
`)(i)}function de(n,i){var e=Y(i,function(t){this.name=i,this.message=t;var o=new Error(t).stack;o!==void 0&&(this.stack=this.toString()+`
`+o.replace(/^Error(:[^\n]*)?\n/,""))});return e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.toString=function(){return this.message===void 0?this.name:this.name+": "+this.message},e}var re=void 0;function Q(n){throw new re(n)}function De(n,i,e){n.forEach(function(v){or[v]=i});function t(v){var g=e(v);g.length!==n.length&&Q("Mismatched type converter count");for(var _=0;_<n.length;++_)rt(n[_],g[_])}var o=new Array(i.length),c=[],p=0;i.forEach((v,g)=>{Ue.hasOwnProperty(v)?o[g]=Ue[v]:(c.push(v),Ie.hasOwnProperty(v)||(Ie[v]=[]),Ie[v].push(()=>{o[g]=Ue[v],++p,p===c.length&&t(o)}))}),c.length===0&&t(o)}function wr(n){var i=et[n];delete et[n];var e=i.rawConstructor,t=i.rawDestructor,o=i.fields,c=o.map(p=>p.getterReturnType).concat(o.map(p=>p.setterArgumentType));De([n],c,p=>{var v={};return o.forEach((g,_)=>{var P=g.fieldName,R=p[_],U=g.getter,B=g.getterContext,V=p[_+o.length],te=g.setter,ee=g.setterContext;v[P]={read:ve=>R.fromWireType(U(B,ve)),write:(ve,Oe)=>{var He=[];te(ee,ve,V.toWireType(He,Oe)),tt(He)}}}),[{name:i.name,fromWireType:function(g){var _={};for(var P in v)_[P]=v[P].read(g);return t(g),_},toWireType:function(g,_){for(var P in v)if(!(P in _))throw new TypeError('Missing field:  "'+P+'"');var R=e();for(P in v)v[P].write(R,_[P]);return g!==null&&g.push(t,R),R},argPackAdvance:8,readValueFromPointer:ct,destructorFunction:t}]})}function br(n,i,e,t,o){}function jt(n){switch(n){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+n)}}function Yt(){for(var n=new Array(256),i=0;i<256;++i)n[i]=String.fromCharCode(i);xt=n}var xt=void 0;function Re(n){for(var i="",e=n;le[e];)i+=xt[le[e++]];return i}var Pt=void 0;function se(n){throw new Pt(n)}function rt(n,i,e={}){if(!("argPackAdvance"in i))throw new TypeError("registerType registeredInstance requires argPackAdvance");var t=i.name;if(n||se('type "'+t+'" must have a positive integer typeid pointer'),Ue.hasOwnProperty(n)){if(e.ignoreDuplicateRegistrations)return;se("Cannot register type '"+t+"' twice")}if(Ue[n]=i,delete or[n],Ie.hasOwnProperty(n)){var o=Ie[n];delete Ie[n],o.forEach(c=>c())}}function Wt(n,i,e,t,o){var c=jt(e);i=Re(i),rt(n,{name:i,fromWireType:function(p){return!!p},toWireType:function(p,v){return v?t:o},argPackAdvance:8,readValueFromPointer:function(p){var v;if(e===1)v=me;else if(e===2)v=ce;else if(e===4)v=ne;else throw new TypeError("Unknown boolean type size: "+i);return this.fromWireType(v[p>>c])},destructorFunction:null})}function Pr(n){if(!(this instanceof Se)||!(n instanceof Se))return!1;for(var i=this.$$.ptrType.registeredClass,e=this.$$.ptr,t=n.$$.ptrType.registeredClass,o=n.$$.ptr;i.baseClass;)e=i.upcast(e),i=i.baseClass;for(;t.baseClass;)o=t.upcast(o),t=t.baseClass;return i===t&&e===o}function dt(n){return{count:n.count,deleteScheduled:n.deleteScheduled,preservePointerOnDelete:n.preservePointerOnDelete,ptr:n.ptr,ptrType:n.ptrType,smartPtr:n.smartPtr,smartPtrType:n.smartPtrType}}function pt(n){function i(e){return e.$$.ptrType.registeredClass.name}se(i(n)+" instance already deleted")}var vt=!1;function it(n){}function rn(n){n.smartPtr?n.smartPtrType.rawDestructor(n.smartPtr):n.ptrType.registeredClass.rawDestructor(n.ptr)}function Ht(n){n.count.value-=1;var i=n.count.value===0;i&&rn(n)}function ht(n,i,e){if(i===e)return n;if(e.baseClass===void 0)return null;var t=ht(n,i,e.baseClass);return t===null?null:e.downcast(t)}var Ur={};function Tt(){return Object.keys(Mt).length}function sr(){var n=[];for(var i in Mt)Mt.hasOwnProperty(i)&&n.push(Mt[i]);return n}var gt=[];function Et(){for(;gt.length;){var n=gt.pop();n.$$.deleteScheduled=!1,n.delete()}}var Kt=void 0;function nn(n){Kt=n,gt.length&&Kt&&Kt(Et)}function Ct(){r.getInheritedInstanceCount=Tt,r.getLiveInheritedInstances=sr,r.flushPendingDeletes=Et,r.setDelayFunction=nn}var Mt={};function yt(n,i){for(i===void 0&&se("ptr should not be undefined");n.baseClass;)i=n.upcast(i),n=n.baseClass;return i}function _t(n,i){return i=yt(n,i),Mt[i]}function St(n,i){(!i.ptrType||!i.ptr)&&Q("makeClassHandle requires ptr and ptrType");var e=!!i.smartPtrType,t=!!i.smartPtr;return e!==t&&Q("Both smartPtrType and smartPtr must be specified"),i.count={value:1},kt(Object.create(n,{$$:{value:i}}))}function on(n){var i=this.getPointee(n);if(!i)return this.destructor(n),null;var e=_t(this.registeredClass,i);if(e!==void 0){if(e.$$.count.value===0)return e.$$.ptr=i,e.$$.smartPtr=n,e.clone();var t=e.clone();return this.destructor(n),t}function o(){return this.isSmartPointer?St(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:i,smartPtrType:this,smartPtr:n}):St(this.registeredClass.instancePrototype,{ptrType:this,ptr:n})}var c=this.registeredClass.getActualType(i),p=Ur[c];if(!p)return o.call(this);var v;this.isConst?v=p.constPointerType:v=p.pointerType;var g=ht(i,this.registeredClass,v.registeredClass);return g===null?o.call(this):this.isSmartPointer?St(v.registeredClass.instancePrototype,{ptrType:v,ptr:g,smartPtrType:this,smartPtr:n}):St(v.registeredClass.instancePrototype,{ptrType:v,ptr:g})}function kt(n){return typeof FinalizationRegistry>"u"?(kt=i=>i,n):(vt=new FinalizationRegistry(i=>{Ht(i.$$)}),kt=i=>{var e=i.$$,t=!!e.smartPtr;if(t){var o={$$:e};vt.register(i,o,i)}return i},it=i=>vt.unregister(i),kt(n))}function Tr(){if(this.$$.ptr||pt(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var n=kt(Object.create(Object.getPrototypeOf(this),{$$:{value:dt(this.$$)}}));return n.$$.count.value+=1,n.$$.deleteScheduled=!1,n}function an(){this.$$.ptr||pt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&se("Object already scheduled for deletion"),it(this),Ht(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)}function sn(){return!this.$$.ptr}function un(){return this.$$.ptr||pt(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&se("Object already scheduled for deletion"),gt.push(this),gt.length===1&&Kt&&Kt(Et),this.$$.deleteScheduled=!0,this}function fn(){Se.prototype.isAliasOf=Pr,Se.prototype.clone=Tr,Se.prototype.delete=an,Se.prototype.isDeleted=sn,Se.prototype.deleteLater=un}function Se(){}function Cr(n,i,e){if(n[i].overloadTable===void 0){var t=n[i];n[i]=function(){return n[i].overloadTable.hasOwnProperty(arguments.length)||se("Function '"+e+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+n[i].overloadTable+")!"),n[i].overloadTable[arguments.length].apply(this,arguments)},n[i].overloadTable=[],n[i].overloadTable[t.argCount]=t}}function ot(n,i,e){r.hasOwnProperty(n)?((e===void 0||r[n].overloadTable!==void 0&&r[n].overloadTable[e]!==void 0)&&se("Cannot register public name '"+n+"' twice"),Cr(r,n,n),r.hasOwnProperty(e)&&se("Cannot register multiple overloads of a function with the same number of arguments ("+e+")!"),r[n].overloadTable[e]=i):(r[n]=i,e!==void 0&&(r[n].numArguments=e))}function Ge(n,i,e,t,o,c,p,v){this.name=n,this.constructor=i,this.instancePrototype=e,this.rawDestructor=t,this.baseClass=o,this.getActualType=c,this.upcast=p,this.downcast=v,this.pureVirtualFunctions=[]}function ur(n,i,e){for(;i!==e;)i.upcast||se("Expected null or instance of "+e.name+", got an instance of "+i.name),n=i.upcast(n),i=i.baseClass;return n}function fr(n,i){if(i===null)return this.isReference&&se("null is not a valid "+this.name),0;i.$$||se('Cannot pass "'+pr(i)+'" as a '+this.name),i.$$.ptr||se("Cannot pass deleted object as a pointer of type "+this.name);var e=i.$$.ptrType.registeredClass,t=ur(i.$$.ptr,e,this.registeredClass);return t}function Qt(n,i){var e;if(i===null)return this.isReference&&se("null is not a valid "+this.name),this.isSmartPointer?(e=this.rawConstructor(),n!==null&&n.push(this.rawDestructor,e),e):0;i.$$||se('Cannot pass "'+pr(i)+'" as a '+this.name),i.$$.ptr||se("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&i.$$.ptrType.isConst&&se("Cannot convert argument of type "+(i.$$.smartPtrType?i.$$.smartPtrType.name:i.$$.ptrType.name)+" to parameter type "+this.name);var t=i.$$.ptrType.registeredClass;if(e=ur(i.$$.ptr,t,this.registeredClass),this.isSmartPointer)switch(i.$$.smartPtr===void 0&&se("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:i.$$.smartPtrType===this?e=i.$$.smartPtr:se("Cannot convert argument of type "+(i.$$.smartPtrType?i.$$.smartPtrType.name:i.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:e=i.$$.smartPtr;break;case 2:if(i.$$.smartPtrType===this)e=i.$$.smartPtr;else{var o=i.clone();e=this.rawShare(e,tr.toHandle(function(){o.delete()})),n!==null&&n.push(this.rawDestructor,e)}break;default:se("Unsupporting sharing policy")}return e}function Ee(n,i){if(i===null)return this.isReference&&se("null is not a valid "+this.name),0;i.$$||se('Cannot pass "'+pr(i)+'" as a '+this.name),i.$$.ptr||se("Cannot pass deleted object as a pointer of type "+this.name),i.$$.ptrType.isConst&&se("Cannot convert argument of type "+i.$$.ptrType.name+" to parameter type "+this.name);var e=i.$$.ptrType.registeredClass,t=ur(i.$$.ptr,e,this.registeredClass);return t}function jr(n){return this.rawGetPointee&&(n=this.rawGetPointee(n)),n}function nt(n){this.rawDestructor&&this.rawDestructor(n)}function je(n){n!==null&&n.delete()}function Ar(){xe.prototype.getPointee=jr,xe.prototype.destructor=nt,xe.prototype.argPackAdvance=8,xe.prototype.readValueFromPointer=ct,xe.prototype.deleteObject=je,xe.prototype.fromWireType=on}function xe(n,i,e,t,o,c,p,v,g,_,P){this.name=n,this.registeredClass=i,this.isReference=e,this.isConst=t,this.isSmartPointer=o,this.pointeeType=c,this.sharingPolicy=p,this.rawGetPointee=v,this.rawConstructor=g,this.rawShare=_,this.rawDestructor=P,!o&&i.baseClass===void 0?t?(this.toWireType=fr,this.destructorFunction=null):(this.toWireType=Ee,this.destructorFunction=null):this.toWireType=Qt}function cr(n,i,e){r.hasOwnProperty(n)||Q("Replacing nonexistant public symbol"),r[n].overloadTable!==void 0&&e!==void 0?r[n].overloadTable[e]=i:(r[n]=i,r[n].argCount=e)}function lr(n,i,e){var t=r["dynCall_"+n];return e&&e.length?t.apply(null,[i].concat(e)):t.call(null,i)}function xr(n,i,e){if(n.includes("j"))return lr(n,i,e);var t=ye(i).apply(null,e);return t}function Wr(n,i){var e=[];return function(){return e.length=0,Object.assign(e,arguments),xr(n,i,e)}}function We(n,i){n=Re(n);function e(){return n.includes("j")?Wr(n,i):ye(i)}var t=e();return typeof t!="function"&&se("unknown function pointer with signature "+n+": "+i),t}var Je=void 0;function Zt(n){var i=b(n),e=Re(i);return h(i),e}function ke(n,i){var e=[],t={};function o(c){if(!t[c]&&!Ue[c]){if(or[c]){or[c].forEach(o);return}e.push(c),t[c]=!0}}throw i.forEach(o),new Je(n+": "+e.map(Zt).join([", "]))}function Xe(n,i,e,t,o,c,p,v,g,_,P,R,U){P=Re(P),c=We(o,c),v&&(v=We(p,v)),_&&(_=We(g,_)),U=We(R,U);var B=lt(P);ot(B,function(){ke("Cannot construct "+P+" due to unbound types",[t])}),De([n,i,e],t?[t]:[],function(V){V=V[0];var te,ee;t?(te=V.registeredClass,ee=te.instancePrototype):ee=Se.prototype;var ve=Y(B,function(){if(Object.getPrototypeOf(this)!==Oe)throw new Pt("Use 'new' to construct "+P);if(He.constructor_body===void 0)throw new Pt(P+" has no accessible constructor");var On=He.constructor_body[arguments.length];if(On===void 0)throw new Pt("Tried to invoke ctor of "+P+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(He.constructor_body).toString()+") parameters instead!");return On.apply(this,arguments)}),Oe=Object.create(ee,{constructor:{value:ve}});ve.prototype=Oe;var He=new Ge(P,ve,Oe,U,te,c,v,_),Sn=new xe(P,He,!0,!1,!1),Vt=new xe(P+"*",He,!1,!1,!1),Wn=new xe(P+" const*",He,!1,!0,!1);return Ur[n]={pointerType:Vt,constPointerType:Wn},cr(B,ve),[Sn,Vt,Wn]})}function dr(n,i){for(var e=[],t=0;t<n;t++)e.push(ae[i+t*4>>2]);return e}function At(n,i){if(!(n instanceof Function))throw new TypeError("new_ called with constructor type "+typeof n+" which is not a function");var e=Y(n.name||"unknownFunctionName",function(){});e.prototype=n.prototype;var t=new e,o=n.apply(t,i);return o instanceof Object?o:t}function $r(n,i,e,t,o){var c=i.length;c<2&&se("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var p=i[1]!==null&&e!==null,v=!1,g=1;g<i.length;++g)if(i[g]!==null&&i[g].destructorFunction===void 0){v=!0;break}for(var _=i[0].name!=="void",P="",R="",g=0;g<c-2;++g)P+=(g!==0?", ":"")+"arg"+g,R+=(g!==0?", ":"")+"arg"+g+"Wired";var U="return function "+lt(n)+"("+P+`) {
if (arguments.length !== `+(c-2)+`) {
throwBindingError('function `+n+" called with ' + arguments.length + ' arguments, expected "+(c-2)+` args!');
}
`;v&&(U+=`var destructors = [];
`);var B=v?"destructors":"null",V=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],te=[se,t,o,tt,i[0],i[1]];p&&(U+="var thisWired = classParam.toWireType("+B+`, this);
`);for(var g=0;g<c-2;++g)U+="var arg"+g+"Wired = argType"+g+".toWireType("+B+", arg"+g+"); // "+i[g+2].name+`
`,V.push("argType"+g),te.push(i[g+2]);if(p&&(R="thisWired"+(R.length>0?", ":"")+R),U+=(_?"var rv = ":"")+"invoker(fn"+(R.length>0?", ":"")+R+`);
`,v)U+=`runDestructors(destructors);
`;else for(var g=p?1:2;g<i.length;++g){var ee=g===1?"thisWired":"arg"+(g-2)+"Wired";i[g].destructorFunction!==null&&(U+=ee+"_dtor("+ee+"); // "+i[g].name+`
`,V.push(ee+"_dtor"),te.push(i[g].destructorFunction))}_&&(U+=`var ret = retType.fromWireType(rv);
return ret;
`),U+=`}
`,V.push(U);var ve=At(Function,V).apply(null,te);return ve}function at(n,i,e,t,o,c){ze(i>0);var p=dr(i,e);o=We(t,o),De([],[n],function(v){v=v[0];var g="constructor "+v.name;if(v.registeredClass.constructor_body===void 0&&(v.registeredClass.constructor_body=[]),v.registeredClass.constructor_body[i-1]!==void 0)throw new Pt("Cannot register multiple constructors with identical number of parameters ("+(i-1)+") for class '"+v.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return v.registeredClass.constructor_body[i-1]=()=>{ke("Cannot construct "+v.name+" due to unbound types",p)},De([],p,function(_){return _.splice(1,0,null),v.registeredClass.constructor_body[i-1]=$r(g,_,null,o,c),[]}),[]})}function $t(n,i,e,t,o,c,p,v){var g=dr(e,t);i=Re(i),c=We(o,c),De([],[n],function(_){_=_[0];var P=_.name+"."+i;i.startsWith("@@")&&(i=Symbol[i.substring(2)]),v&&_.registeredClass.pureVirtualFunctions.push(i);function R(){ke("Cannot call "+P+" due to unbound types",g)}var U=_.registeredClass.instancePrototype,B=U[i];return B===void 0||B.overloadTable===void 0&&B.className!==_.name&&B.argCount===e-2?(R.argCount=e-2,R.className=_.name,U[i]=R):(Cr(U,i,P),U[i].overloadTable[e-2]=R),De([],g,function(V){var te=$r(P,V,_,c,p);return U[i].overloadTable===void 0?(te.argCount=e-2,U[i]=te):U[i].overloadTable[e-2]=te,[]}),[]})}var er=[],Ne=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Hr(n){n>4&&--Ne[n].refcount===0&&(Ne[n]=void 0,er.push(n))}function cn(){for(var n=0,i=5;i<Ne.length;++i)Ne[i]!==void 0&&++n;return n}function ln(){for(var n=5;n<Ne.length;++n)if(Ne[n]!==void 0)return Ne[n];return null}function dn(){r.count_emval_handles=cn,r.get_first_emval=ln}var tr={toValue:n=>(n||se("Cannot use deleted val. handle = "+n),Ne[n].value),toHandle:n=>{switch(n){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:{var i=er.length?er.pop():Ne.length;return Ne[i]={refcount:1,value:n},i}}}};function Mr(n,i){i=Re(i),rt(n,{name:i,fromWireType:function(e){var t=tr.toValue(e);return Hr(e),t},toWireType:function(e,t){return tr.toHandle(t)},argPackAdvance:8,readValueFromPointer:ct,destructorFunction:null})}function pr(n){if(n===null)return"null";var i=typeof n;return i==="object"||i==="array"||i==="function"?n.toString():""+n}function pn(n,i){switch(i){case 2:return function(e){return this.fromWireType(ie[e>>2])};case 3:return function(e){return this.fromWireType(he[e>>3])};default:throw new TypeError("Unknown float type: "+n)}}function vn(n,i,e){var t=jt(e);i=Re(i),rt(n,{name:i,fromWireType:function(o){return o},toWireType:function(o,c){return c},argPackAdvance:8,readValueFromPointer:pn(i,t),destructorFunction:null})}function hn(n,i,e,t,o,c){var p=dr(i,e);n=Re(n),o=We(t,o),ot(n,function(){ke("Cannot call "+n+" due to unbound types",p)},i-1),De([],p,function(v){var g=[v[0],null].concat(v.slice(1));return cr(n,$r(n,g,null,o,c),i-1),[]})}function gn(n,i,e){switch(i){case 0:return e?function(o){return me[o]}:function(o){return le[o]};case 1:return e?function(o){return ce[o>>1]}:function(o){return fe[o>>1]};case 2:return e?function(o){return ne[o>>2]}:function(o){return ae[o>>2]};default:throw new TypeError("Unknown integer type: "+n)}}function yn(n,i,e,t,o){i=Re(i);var c=jt(e),p=R=>R;if(t===0){var v=32-8*e;p=R=>R<<v>>>v}var g=i.includes("unsigned"),_=(R,U)=>{},P;g?P=function(R,U){return _(U,this.name),U>>>0}:P=function(R,U){return _(U,this.name),U},rt(n,{name:i,fromWireType:p,toWireType:P,argPackAdvance:8,readValueFromPointer:gn(i,c,t!==0),destructorFunction:null})}function _n(n,i,e){var t=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],o=t[i];function c(p){p=p>>2;var v=ae,g=v[p],_=v[p+1];return new o(Ye,_,g)}e=Re(e),rt(n,{name:e,fromWireType:c,argPackAdvance:8,readValueFromPointer:c},{ignoreDuplicateRegistrations:!0})}function mn(n,i){i=Re(i);var e=i==="std::string";rt(n,{name:i,fromWireType:function(t){var o=ae[t>>2],c=t+4,p;if(e)for(var v=c,g=0;g<=o;++g){var _=c+g;if(g==o||le[_]==0){var P=_-v,R=bt(v,P);p===void 0?p=R:(p+="\0",p+=R),v=_+1}}else{for(var U=new Array(o),g=0;g<o;++g)U[g]=String.fromCharCode(le[c+g]);p=U.join("")}return h(t),p},toWireType:function(t,o){o instanceof ArrayBuffer&&(o=new Uint8Array(o));var c,p=typeof o=="string";p||o instanceof Uint8Array||o instanceof Uint8ClampedArray||o instanceof Int8Array||se("Cannot pass non-string to std::string"),e&&p?c=nr(o):c=o.length;var v=u(4+c+1),g=v+4;if(ae[v>>2]=c,e&&p)hr(o,g,c+1);else if(p)for(var _=0;_<c;++_){var P=o.charCodeAt(_);P>255&&(h(g),se("String has UTF-16 code units that do not fit in 8 bits")),le[g+_]=P}else for(var _=0;_<c;++_)le[g+_]=o[_];return t!==null&&t.push(h,v),v},argPackAdvance:8,readValueFromPointer:ct,destructorFunction:function(t){h(t)}})}var Lr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function wn(n,i){for(var e=n,t=e>>1,o=t+i/2;!(t>=o)&&fe[t];)++t;if(e=t<<1,e-n>32&&Lr)return Lr.decode(le.subarray(n,e));for(var c="",p=0;!(p>=i/2);++p){var v=ce[n+p*2>>1];if(v==0)break;c+=String.fromCharCode(v)}return c}function bn(n,i,e){if(e===void 0&&(e=2147483647),e<2)return 0;e-=2;for(var t=i,o=e<n.length*2?e/2:n.length,c=0;c<o;++c){var p=n.charCodeAt(c);ce[i>>1]=p,i+=2}return ce[i>>1]=0,i-t}function Vr(n){return n.length*2}function Br(n,i){for(var e=0,t="";!(e>=i/4);){var o=ne[n+e*4>>2];if(o==0)break;if(++e,o>=65536){var c=o-65536;t+=String.fromCharCode(55296|c>>10,56320|c&1023)}else t+=String.fromCharCode(o)}return t}function Pn(n,i,e){if(e===void 0&&(e=2147483647),e<4)return 0;for(var t=i,o=t+e-4,c=0;c<n.length;++c){var p=n.charCodeAt(c);if(p>=55296&&p<=57343){var v=n.charCodeAt(++c);p=65536+((p&1023)<<10)|v&1023}if(ne[i>>2]=p,i+=4,i+4>o)break}return ne[i>>2]=0,i-t}function Rr(n){for(var i=0,e=0;e<n.length;++e){var t=n.charCodeAt(e);t>=55296&&t<=57343&&++e,i+=4}return i}function Nr(n,i,e){e=Re(e);var t,o,c,p,v;i===2?(t=wn,o=bn,p=Vr,c=()=>fe,v=1):i===4&&(t=Br,o=Pn,p=Rr,c=()=>ae,v=2),rt(n,{name:e,fromWireType:function(g){for(var _=ae[g>>2],P=c(),R,U=g+4,B=0;B<=_;++B){var V=g+4+B*i;if(B==_||P[V>>v]==0){var te=V-U,ee=t(U,te);R===void 0?R=ee:(R+="\0",R+=ee),U=V+i}}return h(g),R},toWireType:function(g,_){typeof _!="string"&&se("Cannot pass non-string to C++ string type "+e);var P=p(_),R=u(4+P+i);return ae[R>>2]=P>>v,o(_,R+4,P+i),g!==null&&g.push(h,R),R},argPackAdvance:8,readValueFromPointer:ct,destructorFunction:function(g){h(g)}})}function zr(n,i,e,t,o,c){et[n]={name:Re(i),rawConstructor:We(e,t),rawDestructor:We(o,c),fields:[]}}function Er(n,i,e,t,o,c,p,v,g,_){et[n].fields.push({fieldName:Re(i),getterReturnType:e,getter:We(t,o),getterContext:c,setterArgumentType:p,setter:We(v,g),setterContext:_})}function Tn(n,i){i=Re(i),rt(n,{isVoid:!0,name:i,argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})}function qr(n){n>4&&(Ne[n].refcount+=1)}function Cn(n,i){var e=Ue[n];return e===void 0&&se(i+" has unknown type "+Zt(n)),e}function Gr(n,i){n=Cn(n,"_emval_take_value");var e=n.readValueFromPointer(i);return tr.toHandle(e)}function An(){Gt("")}function $n(n,i,e){le.copyWithin(n,i,i+e)}function Rn(){return 2147483648}function En(n){try{return ge.grow(n-Ye.byteLength+65535>>>16),Bt(ge.buffer),1}catch{}}function Sr(n){var i=le.length;n=n>>>0;var e=Rn();if(n>e)return!1;let t=(g,_)=>g+(_-g%_)%_;for(var o=1;o<=4;o*=2){var c=i*(1+.2/o);c=Math.min(c,n+100663296);var p=Math.min(e,t(Math.max(n,c),65536)),v=En(p);if(v)return!0}return!1}function kr(n){return 52}function Ft(n,i,e,t,o){return 70}var Lt=[null,[],[]];function mt(n,i){var e=Lt[n];i===0||i===10?((n===1?we:_e)(st(e,0)),e.length=0):e.push(i)}function Jr(n,i,e,t){for(var o=0,c=0;c<e;c++){var p=ae[i>>2],v=ae[i+4>>2];i+=8;for(var g=0;g<v;g++)mt(n,le[p+g]);o+=v}return ae[t>>2]=o,0}function Xr(n){return n}function Fr(n){var i=r["_"+n];return i}function Yr(n,i){me.set(n,i)}function vr(n,i,e,t,o){var c={string:V=>{var te=0;if(V!=null&&V!==0){var ee=(V.length<<2)+1;te=A(ee),hr(V,te,ee)}return te},array:V=>{var te=A(V.length);return Yr(V,te),te}};function p(V){return i==="string"?bt(V):i==="boolean"?!!V:V}var v=Fr(n),g=[],_=0;if(t)for(var P=0;P<t.length;P++){var R=c[e[P]];R?(_===0&&(_=k()),g[P]=R(t[P])):g[P]=t[P]}var U=v.apply(null,g);function B(V){return _!==0&&F(_),p(V)}return U=B(U),U}re=r.InternalError=de(Error,"InternalError"),Yt(),Pt=r.BindingError=de(Error,"BindingError"),fn(),Ct(),Ar(),Je=r.UnboundTypeError=de(Error,"UnboundTypeError"),dn();var Kr={L:Ir,v:qe,c:mr,k:Xt,i:Ut,f:It,A:wr,D:br,I:Wt,y:Xe,x:at,a:$t,H:Mr,u:vn,o:hn,h:yn,d:_n,t:mn,q:Nr,p:zr,B:Er,J:Tn,N:Hr,O:qr,n:Gr,r:An,G:$n,E:Sr,F:kr,C:Ft,s:Jr,b:J,z:G,w:T,e:s,l:m,m:a,j:d,K:I,g:K,M:Xr};Or(),r.___wasm_call_ctors=function(){return(r.___wasm_call_ctors=r.asm.Q).apply(null,arguments)};var u=r._malloc=function(){return(u=r._malloc=r.asm.R).apply(null,arguments)},f=r.___cxa_free_exception=function(){return(f=r.___cxa_free_exception=r.asm.S).apply(null,arguments)},h=r._free=function(){return(h=r._free=r.asm.U).apply(null,arguments)},b=r.___getTypeName=function(){return(b=r.___getTypeName=r.asm.V).apply(null,arguments)};r.__embind_initialize_bindings=function(){return(r.__embind_initialize_bindings=r.asm.W).apply(null,arguments)};var C=r.setTempRet0=function(){return(C=r.setTempRet0=r.asm.X).apply(null,arguments)},k=r.stackSave=function(){return(k=r.stackSave=r.asm.Y).apply(null,arguments)},F=r.stackRestore=function(){return(F=r.stackRestore=r.asm.Z).apply(null,arguments)},A=r.stackAlloc=function(){return(A=r.stackAlloc=r.asm._).apply(null,arguments)},O=r.___cxa_can_catch=function(){return(O=r.___cxa_can_catch=r.asm.$).apply(null,arguments)},j=r.___cxa_is_pointer_type=function(){return(j=r.___cxa_is_pointer_type=r.asm.aa).apply(null,arguments)};r.dynCall_ji=function(){return(r.dynCall_ji=r.asm.ba).apply(null,arguments)},r.dynCall_iiji=function(){return(r.dynCall_iiji=r.asm.ca).apply(null,arguments)},r.dynCall_jiji=function(){return(r.dynCall_jiji=r.asm.da).apply(null,arguments)};function G(n,i,e){var t=k();try{return ye(n)(i,e)}catch(o){if(F(t),o!==o+0)throw o;_setThrew(1,0)}}function J(n,i){var e=k();try{return ye(n)(i)}catch(t){if(F(e),t!==t+0)throw t;_setThrew(1,0)}}function K(n,i,e,t,o,c,p,v,g,_,P){var R=k();try{ye(n)(i,e,t,o,c,p,v,g,_,P)}catch(U){if(F(R),U!==U+0)throw U;_setThrew(1,0)}}function s(n,i){var e=k();try{ye(n)(i)}catch(t){if(F(e),t!==t+0)throw t;_setThrew(1,0)}}function a(n,i,e,t){var o=k();try{ye(n)(i,e,t)}catch(c){if(F(o),c!==c+0)throw c;_setThrew(1,0)}}function d(n,i,e,t,o){var c=k();try{ye(n)(i,e,t,o)}catch(p){if(F(c),p!==p+0)throw p;_setThrew(1,0)}}function m(n,i,e){var t=k();try{ye(n)(i,e)}catch(o){if(F(t),o!==o+0)throw o;_setThrew(1,0)}}function T(n,i,e,t){var o=k();try{return ye(n)(i,e,t)}catch(c){if(F(o),c!==c+0)throw c;_setThrew(1,0)}}function I(n,i,e,t,o,c,p){var v=k();try{ye(n)(i,e,t,o,c,p)}catch(g){if(F(v),g!==g+0)throw g;_setThrew(1,0)}}r.ccall=vr;var D;Qe=function n(){D||$(),D||(Qe=n)};function $(n){if(Ke>0||(gr(),Ke>0))return;function i(){D||(D=!0,r.calledRun=!0,!Pe&&(Dr(),x(r),r.onRuntimeInitialized&&r.onRuntimeInitialized(),Zr()))}r.setStatus?(r.setStatus("Running..."),setTimeout(function(){setTimeout(function(){r.setStatus("")},1),i()},1)):i()}if(r.preInit)for(typeof r.preInit=="function"&&(r.preInit=[r.preInit]);r.preInit.length>0;)r.preInit.pop()();return $(),r.ready}})();l.exports=w})(di);var ao=di.exports,so=zn(ao);const uo=new URL("/dicom-viewer/assets/openjphjs-CANpALFP.wasm",import.meta.url),Un={codec:void 0,decoder:void 0,decodeConfig:{}};function fo(l,y,w){const S={width:y,height:w};for(;l>0;)S.width=Math.ceil(S.width/2),S.height=Math.ceil(S.height/2),l--;return S}function co(l){if(Un.decodeConfig=l,Un.codec)return Promise.resolve();const y=so({locateFile:w=>w.endsWith(".wasm")?uo.toString():w});return new Promise((w,S)=>{y.then(E=>{Un.codec=E,Un.decoder=new E.HTJ2KDecoder,w()},S)})}async function lo(l,y){await co();const w=new Un.codec.HTJ2KDecoder,S=w.getEncodedBuffer(l.length);S.set(l);const E=y.decodeLevel||0;w.decodeSubResolution(E);const r=w.getFrameInfo();if(y.decodeLevel>0){const{width:wt,height:st}=fo(y.decodeLevel,r.width,r.height);r.width=wt,r.height=st}const x=w.getDecodedBuffer();new Uint8Array(x.length).set(x);const H=`x: ${w.getImageOffset().x}, y: ${w.getImageOffset().y}`,N=w.getNumDecompositions(),L=w.getNumLayers(),z=["unknown","LRCP","RLCP","RPCL","PCRL","CPRL"][w.getProgressionOrder()+1],M=w.getIsReversible(),X=`${w.getBlockDimensions().width} x ${w.getBlockDimensions().height}`,q=`${w.getTileSize().width} x ${w.getTileSize().height}`,Z=`${w.getTileOffset().x}, ${w.getTileOffset().y}`,ue=`${x.length.toLocaleString()} bytes`,$e=`${(x.length/S.length).toFixed(2)}:1`,pe={columns:r.width,rows:r.height,bitsPerPixel:r.bitsPerSample,signed:r.isSigned,bytesPerPixel:y.bytesPerPixel,componentsPerPixel:r.componentCount};let we=po(r,x);const{buffer:_e,byteOffset:oe,byteLength:ge}=we,Pe=_e.slice(oe,oe+ge);we=new we.constructor(Pe);const ze={imageOffset:H,numDecompositions:N,numLayers:L,progessionOrder:z,reversible:M,blockDimensions:X,tileSize:q,tileOffset:Z,decodedSize:ue,compressionRatio:$e};return{...y,pixelData:we,imageInfo:pe,encodeOptions:ze,...ze,...pe}}function po(l,y){return l.bitsPerSample>8?l.isSigned?new Int16Array(y.buffer,y.byteOffset,y.byteLength/2):new Uint16Array(y.buffer,y.byteOffset,y.byteLength/2):l.isSigned?new Int8Array(y.buffer,y.byteOffset,y.byteLength):new Uint8Array(y.buffer,y.byteOffset,y.byteLength)}function vo(l,y){const w=l.length,{rescaleSlope:S,rescaleIntercept:E,suvbw:r}=y;if(y.modality==="PT"&&typeof r=="number"&&!isNaN(r))for(let x=0;x<w;x++)l[x]=r*(l[x]*S+E);else for(let x=0;x<w;x++)l[x]=l[x]*S+E;return!0}function ho(l){let y=l[0],w=l[0],S;const E=l.length;for(let r=1;r<E;r++)S=l[r],y=Math.min(y,S),w=Math.max(w,S);return{min:y,max:w}}function pi(l,y){let w;return Number.isInteger(l)&&Number.isInteger(y)&&(l>=0?y<=255?w=Uint8Array:y<=65535&&(w=Uint16Array):l>=-128&&y<=127?w=Int8Array:l>=-32768&&y<=32767&&(w=Int16Array)),w||Float32Array}function go(l,y,w){return pi(l,y)===w}function yo(l){return l==="RGB"||l==="PALETTE COLOR"||l==="YBR_FULL"||l==="YBR_FULL_422"||l==="YBR_PARTIAL_422"||l==="YBR_PARTIAL_420"||l==="YBR_RCT"||l==="YBR_ICT"}const _o={bilinear:gi,replicate:yi},ri={Uint8Array,Uint16Array,Int16Array,Float32Array};function mo(l,y,w,S){var pe,we,_e;const E=l.pixelRepresentation!==void 0&&l.pixelRepresentation===1,r=E&&l.bitsStored!==void 0?32-l.bitsStored:void 0;if(E&&r!==void 0)for(let oe=0;oe<l.pixelData.length;oe++)l.pixelData[oe]=l.pixelData[oe]<<r>>r;let x=l.pixelData;l.pixelDataLength=l.pixelData.length;const{min:W,max:H}=ho(l.pixelData),N=typeof y.allowFloatRendering<"u"?y.allowFloatRendering:!0;let L=yo(l.photometricInterpretation)&&((pe=y.targetBuffer)==null?void 0:pe.offset)===void 0;const M=((we=y.preScale)==null?void 0:we.enabled)&&Object.values(y.preScale.scalingParameters).some(oe=>typeof oe=="number"&&!Number.isInteger(oe)),X=!y.preScale.enabled||!N&&M,q=(_e=y.targetBuffer)==null?void 0:_e.type;if(q&&y.preScale.enabled&&!X){const{rescaleSlope:oe,rescaleIntercept:ge}=y.preScale.scalingParameters,Pe=oe*W+ge,ze=oe*H+ge;L=!go(Pe,ze,ri[q])}q&&!L?x=wo(y,l,ri,x):y.preScale.enabled&&!X?x=bo(y,W,H,l):x=vi(W,H,l);let Z=W,ue=H;if(y.preScale.enabled&&!X){const oe=y.preScale.scalingParameters;hi(oe);const{rescaleSlope:ge,rescaleIntercept:Pe}=oe;if(typeof ge=="number"&&typeof Pe=="number"){vo(x,oe),l.preScale={...y.preScale,scaled:!0};const{rescaleIntercept:wt,rescaleSlope:st,suvbw:bt}=oe;Z=st*W+wt,ue=st*H+wt,bt&&(Z=Z*bt,ue=ue*bt)}}else X&&(l.preScale={enabled:!0,scaled:!1},Z=W,ue=H);l.pixelData=x,l.smallestPixelValue=Z,l.largestPixelValue=ue;const $e=new Date().getTime();return l.decodeTimeInMS=$e-w,l}function wo(l,y,w,S){const{arrayBuffer:E,type:r,offset:x=0,length:W,rows:H}=l.targetBuffer,N=w[r];if(!N)throw new Error(`target array ${r} is not supported, or doesn't exist.`);H&&H!=y.rows&&To(y,l.targetBuffer,N);const L=y.pixelDataLength,z=x,M=W??L-z,X=y.pixelData;if(M!==X.length)throw new Error(`target array for image does not have the same length (${M}) as the decoded image length (${X.length}).`);const q=E?new N(E,z,M):new N(M);return q.set(X,0),S=q,S}function bo(l,y,w,S){const E=l.preScale.scalingParameters;hi(E);const{rescaleSlope:r,rescaleIntercept:x}=E,W=typeof r=="number"&&typeof x=="number";let H=y,N=w;return W&&(H=r*y+x,N=r*w+x),vi(H,N,S)}function vi(l,y,w){const S=pi(l,y),E=new S(w.pixelData.length);return E.set(w.pixelData,0),E}function hi(l){if(!l)throw new Error("options.preScale.scalingParameters must be defined if preScale.enabled is true, and scalingParameters cannot be derived from the metadata providers.")}function Po(l,y,w){const{samplesPerPixel:S}=l,{rows:E,columns:r}=y,x=E*r*S,W=new w(x),H=W.byteLength/x;return{pixelData:W,rows:E,columns:r,frameInfo:{...l.frameInfo,rows:E,columns:r},imageInfo:{...l.imageInfo,rows:E,columns:r,bytesPerPixel:H}}}function To(l,y,w){const S=Po(l,y,w),{scalingType:E="replicate"}=y;return _o[E](l,S),Object.assign(l,S),l.pixelDataLength=l.pixelData.length,l}async function Co(l,y,w,S,E,r){const x=new Date().getTime();let W=null,H;switch(y){case"1.2.840.10008.1.2":case"1.2.840.10008.1.2.1":W=Qn(l,w);break;case"1.2.840.10008.1.2.2":W=Di(l,w);break;case"1.2.840.10008.1.2.1.99":W=Qn(l,w);break;case"1.2.840.10008.1.2.5":W=Oi(l,w);break;case"1.2.840.10008.1.2.4.50":H={...l},W=Ni(w,H);break;case"1.2.840.10008.1.2.4.51":W=Gi(l,w);break;case"1.2.840.10008.1.2.4.57":W=Zn(l,w);break;case"1.2.840.10008.1.2.4.70":W=Zn(l,w);break;case"1.2.840.10008.1.2.4.80":H={signed:l.pixelRepresentation===1,bytesPerPixel:l.bitsAllocated<=8?1:2,...l},W=ei(w,H);break;case"1.2.840.10008.1.2.4.81":H={signed:l.pixelRepresentation===1,bytesPerPixel:l.bitsAllocated<=8?1:2,...l},W=ei(w,H);break;case"1.2.840.10008.1.2.4.90":H={...l},W=ti(w,H);break;case"1.2.840.10008.1.2.4.91":H={...l},W=ti(w,H);break;case"3.2.840.10008.1.2.4.96":case"1.2.840.10008.1.2.4.201":case"1.2.840.10008.1.2.4.202":case"1.2.840.10008.1.2.4.203":H={...l},W=lo(w,H);break;default:throw new Error(`no decoder for transfer syntax ${y}`)}if(!W)throw new Error("decodePromise not defined");const N=await W,L=mo(N,E,x);return r==null||r(L),L}const Ao={decodeTask({imageFrame:l,transferSyntax:y,decodeConfig:w,options:S,pixelData:E,callbackFn:r}){return Co(l,y,E,w,S,r)}};Jn(Ao);
